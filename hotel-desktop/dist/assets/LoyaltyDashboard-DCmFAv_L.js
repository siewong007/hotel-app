import{l as Ye,j as e,h as $e,r as c,H as R,a4 as He,B as i,a5 as me,A as h,T as s,o as f,v as H,G as E,D as X,I as Z,n as _,a0 as Ge,a1 as ee,a6 as Oe,q as ue,L as je,w as pe,R as Ue,a7 as Ke,a8 as Ve}from"./index-DnWmqzJF.js";import{u as Je}from"./useCurrency-C4JSCWBJ.js";import{C as p,a as C}from"./CardContent-BhQI87uj.js";import{G as l}from"./Grid-0tqG7FTE.js";import{S as te,T as L}from"./Stars-CybQ7iD1.js";import{C as v}from"./Chip-CSuofl6d.js";import{L as G}from"./Lock-DCccL4KJ.js";import{A as Qe}from"./Add-C7DSqfba.js";import{T as Xe,a as Ze,b as et,c as ge,d as x,e as tt}from"./TableRow-B78mTfEk.js";import{E as st}from"./Edit-v4qS8plG.js";import{D as it}from"./Delete-CC6nSGco.js";import{D as se,a as ie,b as re,c as ne}from"./DialogTitle-DKxRfOzX.js";import{L as ye}from"./LinearProgress-ZsFGqIbl.js";import{R as oe}from"./Redeem-B3k4W0Bq.js";import{I as fe,L as ve}from"./Info-DGREqatQ.js";import{L as be}from"./ListItem-z0t0rr4D.js";import{C as rt}from"./CheckCircle-B5gS3fbx.js";import{T as _e}from"./TrendingUp-BioqpNbz.js";import{M as nt}from"./AttachMoney-oNl3swnH.js";import"./currency-SgYezy9c.js";import"./listItemButtonClasses-Cwcgs-VK.js";const ot=Ye(e.jsx("path",{d:"M7 13c1.66 0 3-1.34 3-3S8.66 7 7 7s-3 1.34-3 3 1.34 3 3 3m12-6h-8v7H3V5H1v15h2v-3h18v3h2v-9c0-2.21-1.79-4-4-4"}),"LocalHotel");function ae(U){const{children:K,value:S,index:m,...F}=U;return e.jsx("div",{role:"tabpanel",hidden:S!==m,id:`loyalty-tabpanel-${m}`,"aria-labelledby":`loyalty-tab-${m}`,...F,children:S===m&&e.jsx(i,{sx:{pt:3},children:K})})}const Ce={1:{name:"Bronze",color:"#CD7F32",gradient:"linear-gradient(135deg, #CD7F32 0%, #B87333 100%)",icon:"ðŸ¥‰",bgColor:"rgba(205, 127, 50, 0.1)"},2:{name:"Silver",color:"#C0C0C0",gradient:"linear-gradient(135deg, #C0C0C0 0%, #A8A8A8 100%)",icon:"ðŸ¥ˆ",bgColor:"rgba(192, 192, 192, 0.1)"},3:{name:"Gold",color:"#FFD700",gradient:"linear-gradient(135deg, #FFD700 0%, #FFA500 100%)",icon:"ðŸ¥‡",bgColor:"rgba(255, 215, 0, 0.1)"},4:{name:"Platinum",color:"#E5E4E2",gradient:"linear-gradient(135deg, #E5E4E2 0%, #B9B9B9 100%)",icon:"ðŸ’Ž",bgColor:"rgba(229, 228, 226, 0.1)"}},O={room_upgrade:e.jsx(ot,{}),service:e.jsx(E,{}),discount:e.jsx(nt,{}),dining:e.jsx(Ve,{}),spa:e.jsx(Ke,{}),gift:e.jsx(E,{}),experience:e.jsx(L,{})},wt=()=>{const{hasRole:U,hasPermission:K}=$e(),{symbol:S}=Je(),m=U("admin")||K("analytics:write"),F=c.useRef(!1),[q,ke]=c.useState(0),[D,u]=c.useState(!0),[r,Re]=c.useState(null),[B,Se]=c.useState([]),[Ie,we]=c.useState([]),[d,M]=c.useState(null),[De,N]=c.useState(!1),[We,P]=c.useState(!1),[Te,Y]=c.useState(!1),[le,V]=c.useState(""),[W,k]=c.useState(null),[T,I]=c.useState(null),[z,ce]=c.useState("all"),[o,g]=c.useState({}),[b,de]=c.useState(null),[ze,J]=c.useState(!1);c.useEffect(()=>{F.current||(F.current=!0,$())},[]);const $=async()=>{try{if(u(!0),k(null),m)try{const t=await R.getRewards();we(t)}catch(t){console.error("Failed to load rewards:",t),k(t.message||"Failed to load rewards")}else{try{const n=await R.getEkycStatus();if(!n||n===null){de("not_started"),J(!0),u(!1);return}if(de(n.status),n.status!=="approved"){J(!0),u(!1);return}}catch(n){console.warn("Failed to check eKYC status:",n),J(!0),u(!1);return}let t=null,a=[];try{t=await R.getUserLoyaltyMembership()}catch(n){if(n instanceof He&&n.response.status===404)console.log("No loyalty membership found for user");else throw n}try{a=await R.getLoyaltyRewards()}catch(n){console.warn("Failed to load rewards:",n)}Re(t),Se(a)}}catch(t){console.error("Failed to load loyalty data:",t),k(t.message||"Failed to load loyalty information")}finally{u(!1)}},Ae=t=>{M(t),N(!0),V("")},Be=async()=>{if(!(!d||!r))try{u(!0),await R.redeemReward({reward_id:d.id,notes:le||void 0}),I(`Successfully redeemed: ${d.name}`),N(!1),M(null),V(""),await $()}catch(t){k(t.message||"Failed to redeem reward")}finally{u(!1)}},Pe=t=>{g(t),P(!0)},Le=()=>{g({name:"",description:"",category:"service",points_cost:0,minimum_tier_level:1}),P(!0)},Ee=async()=>{try{if(u(!0),o.id){const t={name:o.name,description:o.description,category:o.category,points_cost:o.points_cost,monetary_value:o.monetary_value,minimum_tier_level:o.minimum_tier_level,is_active:o.is_active,stock_quantity:o.stock_quantity,image_url:o.image_url,terms_conditions:o.terms_conditions};await R.updateReward(o.id,t),I("Reward updated successfully")}else await R.createReward(o),I("Reward created successfully");P(!1),await $()}catch(t){k(t.message||"Failed to save reward")}finally{u(!1)}},Fe=t=>{M(t),Y(!0)},qe=async()=>{if(d)try{u(!0),await R.deleteReward(d.id),I("Reward deleted successfully"),Y(!1),M(null),await $()}catch(t){k(t.message||"Failed to delete reward")}finally{u(!1)}},xe=t=>new Date(t).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}),j=t=>new Intl.NumberFormat("en-US").format(t),y=t=>Ce[t]||Ce[1],Me=()=>{if(!r||!r.next_tier)return 100;const t=r.lifetime_points,a=r.next_tier.minimum_points,n=r.tier_level===1?0:r.tier_level===2?1e3:r.tier_level===3?5e3:1e4,w=(t-n)/(a-n)*100;return Math.min(Math.max(w,0),100)},he=z==="all"?B:B.filter(t=>t.category===z),Ne=Array.from(new Set(B.map(t=>t.category)));if(D&&!r&&!m)return e.jsx(i,{sx:{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"60vh"},children:e.jsx(me,{size:80})});if(ze&&!m){const t=b!=="pending"&&b!=="under_review";return e.jsxs(i,{sx:{m:3},children:[e.jsxs(h,{severity:"warning",sx:{mb:2},children:[e.jsx(s,{variant:"h6",gutterBottom:!0,children:"eKYC Verification Required"}),e.jsx(s,{variant:"body2",paragraph:!0,children:"To participate in our Loyalty Rewards Program, you must complete the eKYC (Electronic Know Your Customer) verification process."}),e.jsxs(s,{variant:"body2",paragraph:!0,children:["Current Status: ",e.jsx("strong",{children:b||"Not Started"})]}),(b==="pending"||b==="under_review")&&e.jsx(s,{variant:"body2",color:"text.secondary",children:"Your eKYC submission is under review. You'll be able to access loyalty rewards once it's approved."}),b==="rejected"&&e.jsx(s,{variant:"body2",color:"error",children:"Your eKYC submission was rejected. Please resubmit with correct information."}),(!b||b==="not_started"||b==="unverified")&&e.jsx(s,{variant:"body2",color:"text.secondary",children:"Please complete the eKYC verification to unlock loyalty rewards."})]}),t&&e.jsx(f,{variant:"contained",color:"primary",href:"/profile",sx:{mt:2},children:"Go to Profile to Complete eKYC"})]})}if(W&&!r&&!m)return e.jsx(h,{severity:"error",sx:{m:3},children:W});if(!r&&!m)return e.jsxs(i,{children:[T&&e.jsx(h,{severity:"success",onClose:()=>I(null),sx:{mb:2},children:T}),e.jsxs(i,{sx:{mb:4},children:[e.jsx(s,{variant:"h4",gutterBottom:!0,sx:{fontWeight:700,color:"primary.main"},children:"Loyalty Rewards"}),e.jsx(s,{variant:"body1",color:"text.secondary",children:"Discover rewards you can earn through our loyalty program"})]}),e.jsx(p,{sx:{mb:4,background:"linear-gradient(135deg, #CD7F32 0%, #B87333 100%)",color:"white"},children:e.jsx(C,{sx:{p:3},children:e.jsxs(l,{container:!0,spacing:3,alignItems:"center",children:[e.jsx(l,{item:!0,xs:12,md:6,children:e.jsxs(i,{sx:{display:"flex",alignItems:"center",gap:2},children:[e.jsx(H,{sx:{width:64,height:64,bgcolor:"rgba(255,255,255,0.2)"},children:e.jsx(te,{sx:{fontSize:32}})}),e.jsxs(i,{children:[e.jsx(s,{variant:"body2",sx:{opacity:.9,mb:.5},children:"Current Points Balance"}),e.jsx(s,{variant:"h3",sx:{fontWeight:700},children:"0"})]})]})}),e.jsx(l,{item:!0,xs:12,md:6,children:e.jsx(h,{severity:"info",sx:{bgcolor:"rgba(255,255,255,0.2)",color:"white","& .MuiAlert-icon":{color:"white"}},children:e.jsxs(s,{variant:"body2",children:[e.jsx("strong",{children:"Not enrolled yet?"})," Contact support to join our loyalty program and start earning points with every booking!"]})})})]})})}),e.jsxs(i,{sx:{mb:3},children:[e.jsx(s,{variant:"h5",gutterBottom:!0,sx:{fontWeight:600},children:"Available Rewards"}),e.jsx(s,{variant:"body2",color:"text.secondary",paragraph:!0,children:"Here are the rewards you can earn once you join our loyalty program"})]}),B.length===0?e.jsx(h,{severity:"info",children:"No rewards available at the moment. Check back later!"}):e.jsx(l,{container:!0,spacing:3,children:B.map(t=>{const a=y(t.minimum_tier_level);return e.jsx(l,{item:!0,xs:12,sm:6,md:4,children:e.jsxs(p,{sx:{height:"100%",display:"flex",flexDirection:"column",position:"relative",transition:"all 0.3s ease","&:hover":{transform:"translateY(-4px)",boxShadow:6}},children:[e.jsx(i,{sx:{position:"absolute",top:10,right:10,zIndex:1},children:e.jsx(v,{label:a.name,size:"small",sx:{bgcolor:a.bgColor,color:a.color,fontWeight:600}})}),t.stock_quantity!==null&&t.stock_quantity!==void 0&&e.jsx(i,{sx:{position:"absolute",top:10,left:10,zIndex:1},children:e.jsx(v,{label:`${t.stock_quantity} left`,size:"small",color:t.stock_quantity<10?"error":"default",sx:{fontWeight:600}})}),e.jsx(i,{sx:{height:200,background:t.image_url?`url(${t.image_url})`:`linear-gradient(135deg, ${a.color} 0%, ${a.color}80 100%)`,backgroundSize:"cover",backgroundPosition:"center",display:"flex",alignItems:"center",justifyContent:"center"},children:!t.image_url&&e.jsx(i,{sx:{fontSize:"5rem",opacity:.3},children:O[t.category]||e.jsx(E,{sx:{fontSize:80}})})}),e.jsxs(C,{sx:{flexGrow:1,display:"flex",flexDirection:"column"},children:[e.jsxs(i,{sx:{mb:2},children:[e.jsx(s,{variant:"h6",gutterBottom:!0,sx:{fontWeight:600},children:t.name}),e.jsx(s,{variant:"body2",color:"text.secondary",sx:{mb:2},children:t.description})]}),e.jsxs(i,{sx:{mt:"auto"},children:[e.jsx(X,{sx:{mb:2}}),e.jsxs(i,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2},children:[e.jsxs(i,{sx:{display:"flex",alignItems:"center",gap:.5},children:[e.jsx(te,{sx:{color:"warning.main",fontSize:20}}),e.jsx(s,{variant:"h6",sx:{fontWeight:700},children:j(t.points_cost)}),e.jsx(s,{variant:"caption",color:"text.secondary",children:"points"})]}),t.monetary_value&&e.jsxs(s,{variant:"body2",color:"success.main",sx:{fontWeight:600},children:[S,t.monetary_value," value"]})]}),e.jsx(f,{fullWidth:!0,variant:"outlined",disabled:!0,startIcon:e.jsx(G,{}),children:"Join to Redeem"})]})]})]})},t.id)})})]});if(m)return e.jsxs(i,{children:[T&&e.jsx(h,{severity:"success",onClose:()=>I(null),sx:{mb:2},children:T}),W&&e.jsx(h,{severity:"error",onClose:()=>k(null),sx:{mb:2},children:W}),e.jsxs(i,{sx:{mb:4,display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsxs(i,{children:[e.jsx(s,{variant:"h4",gutterBottom:!0,sx:{fontWeight:700,color:"primary.main"},children:"Rewards Management"}),e.jsx(s,{variant:"body1",color:"text.secondary",children:"Manage all loyalty rewards and redemptions"})]}),e.jsx(f,{variant:"contained",startIcon:e.jsx(Qe,{}),onClick:Le,children:"Create Reward"})]}),e.jsx(p,{children:e.jsx(Xe,{children:e.jsxs(Ze,{children:[e.jsx(et,{children:e.jsxs(ge,{children:[e.jsx(x,{children:"Name"}),e.jsx(x,{children:"Category"}),e.jsx(x,{children:"Points Cost"}),e.jsx(x,{children:"Min. Tier"}),e.jsx(x,{children:"Stock"}),e.jsx(x,{children:"Value"}),e.jsx(x,{children:"Actions"})]})}),e.jsx(tt,{children:Ie.map(t=>e.jsxs(ge,{children:[e.jsxs(x,{children:[e.jsx(s,{variant:"body2",fontWeight:600,children:t.name}),e.jsx(s,{variant:"caption",color:"text.secondary",children:t.description})]}),e.jsx(x,{children:e.jsx(v,{icon:O[t.category],label:t.category.split("_").map(a=>a.charAt(0).toUpperCase()+a.slice(1)).join(" "),size:"small"})}),e.jsx(x,{children:j(t.points_cost)}),e.jsx(x,{children:e.jsx(v,{label:y(t.minimum_tier_level).name,size:"small",sx:{bgcolor:y(t.minimum_tier_level).bgColor,color:y(t.minimum_tier_level).color}})}),e.jsx(x,{children:t.stock_quantity!==null&&t.stock_quantity!==void 0?t.stock_quantity:"âˆž"}),e.jsx(x,{children:t.monetary_value?`${S}${t.monetary_value}`:"-"}),e.jsxs(x,{children:[e.jsx(Z,{size:"small",onClick:()=>Pe(t),color:"primary",children:e.jsx(st,{})}),e.jsx(Z,{size:"small",onClick:()=>Fe(t),color:"error",children:e.jsx(it,{})})]})]},t.id))})]})})}),e.jsxs(se,{open:We,onClose:()=>P(!1),maxWidth:"sm",fullWidth:!0,children:[e.jsx(ie,{children:o.id?"Edit Reward":"Create Reward"}),e.jsx(re,{children:e.jsxs(l,{container:!0,spacing:2,sx:{mt:1},children:[e.jsx(l,{item:!0,xs:12,children:e.jsx(_,{fullWidth:!0,label:"Name",value:o.name||"",onChange:t=>g({...o,name:t.target.value})})}),e.jsx(l,{item:!0,xs:12,children:e.jsx(_,{fullWidth:!0,label:"Description",multiline:!0,rows:3,value:o.description||"",onChange:t=>g({...o,description:t.target.value})})}),e.jsx(l,{item:!0,xs:12,sm:6,children:e.jsxs(_,{fullWidth:!0,label:"Category",select:!0,value:o.category||"service",onChange:t=>g({...o,category:t.target.value}),SelectProps:{native:!0},children:[e.jsx("option",{value:"service",children:"Service"}),e.jsx("option",{value:"room_upgrade",children:"Room Upgrade"}),e.jsx("option",{value:"dining",children:"Dining"}),e.jsx("option",{value:"spa",children:"Spa"}),e.jsx("option",{value:"discount",children:"Discount"}),e.jsx("option",{value:"gift",children:"Gift"}),e.jsx("option",{value:"experience",children:"Experience"})]})}),e.jsx(l,{item:!0,xs:12,sm:6,children:e.jsx(_,{fullWidth:!0,label:"Points Cost",type:"number",value:o.points_cost||0,onChange:t=>g({...o,points_cost:parseInt(t.target.value)})})}),e.jsx(l,{item:!0,xs:12,sm:6,children:e.jsx(_,{fullWidth:!0,label:"Minimum Tier Level",type:"number",value:o.minimum_tier_level||1,onChange:t=>g({...o,minimum_tier_level:parseInt(t.target.value)}),inputProps:{min:1,max:4}})}),e.jsx(l,{item:!0,xs:12,sm:6,children:e.jsx(_,{fullWidth:!0,label:"Stock Quantity",type:"number",value:o.stock_quantity||"",onChange:t=>g({...o,stock_quantity:t.target.value?parseInt(t.target.value):void 0})})}),e.jsx(l,{item:!0,xs:12,sm:6,children:e.jsx(_,{fullWidth:!0,label:`Monetary Value (${S})`,type:"number",value:o.monetary_value||"",onChange:t=>g({...o,monetary_value:t.target.value?parseFloat(t.target.value):void 0})})}),e.jsx(l,{item:!0,xs:12,children:e.jsx(_,{fullWidth:!0,label:"Terms & Conditions",multiline:!0,rows:2,value:o.terms_conditions||"",onChange:t=>g({...o,terms_conditions:t.target.value})})})]})}),e.jsxs(ne,{children:[e.jsx(f,{onClick:()=>P(!1),children:"Cancel"}),e.jsx(f,{onClick:Ee,variant:"contained",disabled:D,children:o.id?"Update":"Create"})]})]}),e.jsxs(se,{open:Te,onClose:()=>Y(!1),children:[e.jsx(ie,{children:"Delete Reward"}),e.jsx(re,{children:e.jsxs(s,{children:['Are you sure you want to delete "',d==null?void 0:d.name,'"? This action cannot be undone.']})}),e.jsxs(ne,{children:[e.jsx(f,{onClick:()=>Y(!1),children:"Cancel"}),e.jsx(f,{onClick:qe,color:"error",variant:"contained",disabled:D,children:"Delete"})]})]})]});const A=y(r.tier_level),Q=Me();return e.jsxs(i,{children:[T&&e.jsx(h,{severity:"success",onClose:()=>I(null),sx:{mb:2},children:T}),W&&e.jsx(h,{severity:"error",onClose:()=>k(null),sx:{mb:2},children:W}),e.jsxs(i,{sx:{mb:4},children:[e.jsx(s,{variant:"h4",gutterBottom:!0,sx:{fontWeight:700,color:"primary.main"},children:"Loyalty Rewards"}),e.jsx(s,{variant:"body1",color:"text.secondary",children:"Earn points with every stay and unlock exclusive rewards"})]}),e.jsxs(p,{sx:{mb:3,background:A.gradient,color:"white",position:"relative",overflow:"hidden"},children:[e.jsx(i,{sx:{position:"absolute",top:-50,right:-50,fontSize:"200px",opacity:.1},children:A.icon}),e.jsx(C,{sx:{position:"relative",zIndex:1},children:e.jsxs(l,{container:!0,spacing:3,alignItems:"center",children:[e.jsx(l,{item:!0,xs:12,md:4,children:e.jsxs(i,{sx:{display:"flex",alignItems:"center",mb:2},children:[e.jsx(H,{sx:{width:80,height:80,bgcolor:"rgba(255,255,255,0.2)",fontSize:"3rem",mr:2},children:A.icon}),e.jsxs(i,{children:[e.jsxs(s,{variant:"h5",sx:{fontWeight:700},children:[A.name," Member"]}),e.jsxs(s,{variant:"body2",sx:{opacity:.9},children:["Member since ",xe(r.enrolled_date)]}),e.jsxs(s,{variant:"caption",sx:{opacity:.8},children:["#",r.membership_number]})]})]})}),e.jsx(l,{item:!0,xs:12,md:4,children:e.jsxs(i,{sx:{textAlign:"center"},children:[e.jsx(s,{variant:"h3",sx:{fontWeight:700,mb:1},children:j(r.points_balance)}),e.jsx(s,{variant:"body1",sx:{opacity:.9},children:"Available Points"}),e.jsxs(s,{variant:"caption",sx:{opacity:.7},children:[j(r.lifetime_points)," lifetime points earned"]})]})}),e.jsx(l,{item:!0,xs:12,md:4,children:r.next_tier?e.jsxs(i,{children:[e.jsxs(i,{sx:{display:"flex",justifyContent:"space-between",mb:1},children:[e.jsxs(s,{variant:"body2",children:["Progress to ",r.next_tier.tier_name]}),e.jsxs(s,{variant:"body2",sx:{fontWeight:600},children:[Math.round(Q),"%"]})]}),e.jsx(ye,{variant:"determinate",value:Q,sx:{height:10,borderRadius:5,bgcolor:"rgba(255,255,255,0.3)","& .MuiLinearProgress-bar":{bgcolor:"white",borderRadius:5}}}),e.jsxs(s,{variant:"caption",sx:{opacity:.8,mt:1,display:"block"},children:[j(r.points_to_next_tier||0)," more points needed"]})]}):e.jsxs(i,{sx:{textAlign:"center"},children:[e.jsx(L,{sx:{fontSize:48,mb:1}}),e.jsx(s,{variant:"body1",children:"You've reached the highest tier!"})]})})]})})]}),e.jsx(p,{sx:{mb:3},children:e.jsxs(Ge,{value:q,onChange:(t,a)=>ke(a),variant:"fullWidth",sx:{borderBottom:1,borderColor:"divider"},children:[e.jsx(ee,{icon:e.jsx(E,{}),label:"Rewards Catalog",iconPosition:"start"}),e.jsx(ee,{icon:e.jsx(L,{}),label:"My Benefits",iconPosition:"start"}),e.jsx(ee,{icon:e.jsx(Oe,{}),label:"Points History",iconPosition:"start"})]})}),e.jsxs(ae,{value:q,index:0,children:[e.jsxs(i,{sx:{mb:3,display:"flex",gap:1,flexWrap:"wrap"},children:[e.jsx(v,{label:"All Rewards",onClick:()=>ce("all"),color:z==="all"?"primary":"default",sx:{fontWeight:z==="all"?600:400}}),Ne.map(t=>e.jsx(v,{icon:O[t],label:t.split("_").map(a=>a.charAt(0).toUpperCase()+a.slice(1)).join(" "),onClick:()=>ce(t),color:z===t?"primary":"default",sx:{fontWeight:z===t?600:400}},t))]}),e.jsx(l,{container:!0,spacing:3,children:he.map(t=>{const a=r.points_balance>=t.points_cost&&r.tier_level>=t.minimum_tier_level,n=r.tier_level<t.minimum_tier_level;return e.jsx(l,{item:!0,xs:12,sm:6,md:4,children:e.jsxs(p,{sx:{height:"100%",display:"flex",flexDirection:"column",position:"relative",transition:"all 0.3s ease",opacity:n?.6:1,"&:hover":{transform:n?"none":"translateY(-4px)",boxShadow:n?void 0:6}},children:[n&&e.jsx(i,{sx:{position:"absolute",top:10,right:10,zIndex:1},children:e.jsx(ue,{title:`Requires ${y(t.minimum_tier_level).name} tier`,children:e.jsx(v,{icon:e.jsx(G,{}),label:y(t.minimum_tier_level).name,size:"small",sx:{bgcolor:"rgba(0,0,0,0.7)",color:"white"}})})}),t.stock_quantity!==null&&t.stock_quantity!==void 0&&e.jsx(i,{sx:{position:"absolute",top:10,left:10,zIndex:1},children:e.jsx(v,{label:`${t.stock_quantity} left`,size:"small",color:t.stock_quantity<10?"error":"default",sx:{fontWeight:600}})}),e.jsx(i,{sx:{height:200,background:t.image_url?`url(${t.image_url})`:`linear-gradient(135deg, ${y(t.minimum_tier_level).color} 0%, ${y(t.minimum_tier_level).color}80 100%)`,backgroundSize:"cover",backgroundPosition:"center",display:"flex",alignItems:"center",justifyContent:"center"},children:!t.image_url&&e.jsx(i,{sx:{fontSize:"5rem",opacity:.3},children:O[t.category]||e.jsx(E,{sx:{fontSize:80}})})}),e.jsxs(C,{sx:{flexGrow:1,display:"flex",flexDirection:"column"},children:[e.jsxs(i,{sx:{mb:2},children:[e.jsx(s,{variant:"h6",gutterBottom:!0,sx:{fontWeight:600},children:t.name}),e.jsx(s,{variant:"body2",color:"text.secondary",sx:{mb:2},children:t.description})]}),e.jsxs(i,{sx:{mt:"auto"},children:[e.jsx(X,{sx:{mb:2}}),e.jsxs(i,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2},children:[e.jsxs(i,{sx:{display:"flex",alignItems:"center",gap:.5},children:[e.jsx(te,{sx:{color:"warning.main",fontSize:20}}),e.jsx(s,{variant:"h6",sx:{fontWeight:700},children:j(t.points_cost)}),e.jsx(s,{variant:"caption",color:"text.secondary",children:"points"})]}),t.monetary_value&&e.jsxs(s,{variant:"caption",color:"text.secondary",children:["Value: ",S,t.monetary_value]})]}),e.jsx(f,{fullWidth:!0,variant:a?"contained":"outlined",disabled:!a||D,onClick:()=>Ae(t),startIcon:n?e.jsx(G,{}):e.jsx(oe,{}),children:n?"Tier Locked":a?"Redeem Now":"Insufficient Points"}),t.terms_conditions&&e.jsx(ue,{title:t.terms_conditions,children:e.jsx(Z,{size:"small",sx:{mt:1},children:e.jsx(fe,{fontSize:"small"})})})]})]})]})},t.id)})}),he.length===0&&e.jsx(h,{severity:"info",children:"No rewards available in this category."})]}),e.jsx(ae,{value:q,index:1,children:e.jsxs(l,{container:!0,spacing:3,children:[e.jsx(l,{item:!0,xs:12,md:6,children:e.jsx(p,{children:e.jsxs(C,{children:[e.jsxs(s,{variant:"h6",gutterBottom:!0,sx:{fontWeight:600,display:"flex",alignItems:"center",gap:1},children:[e.jsx(L,{color:"primary"}),"Current Tier Benefits"]}),e.jsx(je,{children:r.current_tier_benefits.map((t,a)=>e.jsxs(be,{children:[e.jsx(ve,{children:e.jsx(H,{sx:{bgcolor:A.bgColor,color:A.color},children:e.jsx(rt,{})})}),e.jsx(pe,{primary:t})]},a))})]})})}),r.next_tier&&e.jsx(l,{item:!0,xs:12,md:6,children:e.jsx(p,{sx:{border:2,borderColor:"primary.main"},children:e.jsxs(C,{children:[e.jsxs(s,{variant:"h6",gutterBottom:!0,sx:{fontWeight:600,display:"flex",alignItems:"center",gap:1},children:[e.jsx(_e,{color:"primary"}),"Unlock at ",r.next_tier.tier_name]}),e.jsxs(i,{sx:{mb:2},children:[e.jsx(ye,{variant:"determinate",value:Q,sx:{height:8,borderRadius:4,mb:1}}),e.jsxs(s,{variant:"body2",color:"text.secondary",children:[j(r.points_to_next_tier||0)," points away"]})]}),e.jsxs(h,{severity:"info",icon:e.jsx(L,{}),children:["Earn ",e.jsxs("strong",{children:[r.next_tier.points_multiplier,"x"]})," points on all stays at ",r.next_tier.tier_name," level!"]})]})})}),e.jsx(l,{item:!0,xs:12,children:e.jsx(p,{children:e.jsxs(C,{children:[e.jsx(s,{variant:"h6",gutterBottom:!0,sx:{fontWeight:600},children:"Tier Comparison"}),e.jsx(l,{container:!0,spacing:2,children:[1,2,3,4].map(t=>{const a=y(t),n=t===r.tier_level,w=t>r.tier_level;return e.jsx(l,{item:!0,xs:12,sm:6,md:3,children:e.jsx(p,{sx:{background:n?a.gradient:void 0,color:n?"white":void 0,border:n?3:1,borderColor:n?a.color:"divider",opacity:w?.7:1},children:e.jsx(C,{children:e.jsxs(i,{sx:{textAlign:"center"},children:[e.jsx(s,{variant:"h2",children:a.icon}),e.jsx(s,{variant:"h6",sx:{fontWeight:600,mt:1},children:a.name}),n&&e.jsx(v,{label:"Current",size:"small",sx:{mt:1,bgcolor:"rgba(255,255,255,0.3)",color:"white"}}),w&&e.jsx(v,{icon:e.jsx(G,{}),label:"Locked",size:"small",sx:{mt:1}})]})})})},t)})})]})})})]})}),e.jsx(ae,{value:q,index:2,children:e.jsx(p,{children:e.jsxs(C,{children:[e.jsx(s,{variant:"h6",gutterBottom:!0,sx:{fontWeight:600,mb:3},children:"Recent Transactions"}),e.jsx(je,{children:r.recent_transactions.map((t,a)=>{const n=t.transaction_type==="earn",w=t.transaction_type==="redeem";return e.jsxs(Ue.Fragment,{children:[a>0&&e.jsx(X,{}),e.jsxs(be,{children:[e.jsx(ve,{children:e.jsx(H,{sx:{bgcolor:n?"success.light":w?"error.light":"grey.300",color:n?"success.dark":w?"error.dark":"grey.700"},children:n?e.jsx(_e,{}):e.jsx(oe,{})})}),e.jsx(pe,{primary:e.jsxs(i,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center"},children:[e.jsx(s,{variant:"body1",children:t.description||t.transaction_type}),e.jsxs(s,{variant:"h6",sx:{color:n?"success.main":"error.main",fontWeight:600},children:[n?"+":"",j(t.points_amount)]})]}),secondary:e.jsxs(i,{sx:{display:"flex",justifyContent:"space-between",mt:.5},children:[e.jsx(s,{variant:"caption",color:"text.secondary",children:xe(t.created_at)}),e.jsxs(s,{variant:"caption",color:"text.secondary",children:["Balance: ",j(t.balance_after)]})]})})]})]},t.id)})}),r.recent_transactions.length===0&&e.jsx(h,{severity:"info",children:"No transactions yet. Start earning points with your first booking!"})]})})}),e.jsxs(se,{open:De,onClose:()=>N(!1),maxWidth:"sm",fullWidth:!0,children:[e.jsx(ie,{children:"Confirm Reward Redemption"}),e.jsx(re,{children:d&&e.jsxs(i,{children:[e.jsx(s,{variant:"h6",gutterBottom:!0,children:d.name}),e.jsx(s,{variant:"body2",color:"text.secondary",paragraph:!0,children:d.description}),e.jsxs(i,{sx:{bgcolor:"background.default",p:2,borderRadius:2,mb:2},children:[e.jsx(s,{variant:"body2",gutterBottom:!0,children:"Points to be deducted:"}),e.jsxs(s,{variant:"h5",sx:{fontWeight:700,color:"primary.main"},children:[j(d.points_cost)," points"]}),e.jsxs(s,{variant:"caption",color:"text.secondary",children:["New balance: ",j(((r==null?void 0:r.points_balance)||0)-d.points_cost)," points"]})]}),e.jsx(_,{fullWidth:!0,label:"Notes (optional)",multiline:!0,rows:3,value:le,onChange:t=>V(t.target.value),placeholder:"Add any special requests or notes...",sx:{mb:2}}),d.terms_conditions&&e.jsx(h,{severity:"info",icon:e.jsx(fe,{}),children:e.jsxs(s,{variant:"caption",children:[e.jsx("strong",{children:"Terms & Conditions:"})," ",d.terms_conditions]})})]})}),e.jsxs(ne,{children:[e.jsx(f,{onClick:()=>N(!1),children:"Cancel"}),e.jsx(f,{onClick:Be,variant:"contained",disabled:D,startIcon:D?e.jsx(me,{size:20}):e.jsx(oe,{}),children:"Confirm Redemption"})]})]})]})};export{wt as default};
