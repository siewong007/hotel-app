import{h as he,r as s,j as e,B as r,C as ae,T as i,A as c,D as g,n,ad as me,o as C}from"./index-DnWmqzJF.js";import{g as xe,S as ge,s as pe,a as je}from"./currency-SgYezy9c.js";import{u as be}from"./useCurrency-C4JSCWBJ.js";import{C as p,a as j}from"./CardContent-BhQI87uj.js";import{B as ve}from"./Business-D15Uf3Sq.js";import{G as a}from"./Grid-0tqG7FTE.js";import{S as fe}from"./Schedule-CXw4xcpD.js";import{M as ie}from"./AttachMoney-oNl3swnH.js";import{S as ne}from"./Stack-DcjgMJBo.js";import{C as re}from"./Chip-CSuofl6d.js";import{A as le}from"./Add-C7DSqfba.js";import{S as ye}from"./Save-B20zNACZ.js";const _=[{value:"Asia/Kuala_Lumpur",label:"Malaysia (Kuala Lumpur) - GMT+8",region:"Asia"},{value:"Asia/Singapore",label:"Singapore - GMT+8",region:"Asia"},{value:"Asia/Bangkok",label:"Thailand (Bangkok) - GMT+7",region:"Asia"},{value:"Asia/Jakarta",label:"Indonesia (Jakarta) - GMT+7",region:"Asia"},{value:"Asia/Manila",label:"Philippines (Manila) - GMT+8",region:"Asia"},{value:"Asia/Hong_Kong",label:"Hong Kong - GMT+8",region:"Asia"},{value:"Asia/Tokyo",label:"Japan (Tokyo) - GMT+9",region:"Asia"},{value:"Asia/Shanghai",label:"China (Shanghai) - GMT+8",region:"Asia"},{value:"Asia/Dubai",label:"UAE (Dubai) - GMT+4",region:"Asia"},{value:"Australia/Sydney",label:"Australia (Sydney) - GMT+10/+11",region:"Pacific"},{value:"Europe/London",label:"United Kingdom (London) - GMT+0/+1",region:"Europe"},{value:"Europe/Paris",label:"France (Paris) - GMT+1/+2",region:"Europe"},{value:"America/New_York",label:"USA (New York) - GMT-5/-4",region:"Americas"},{value:"America/Los_Angeles",label:"USA (Los Angeles) - GMT-8/-7",region:"Americas"},{value:"America/Chicago",label:"USA (Chicago) - GMT-6/-5",region:"Americas"}],Ge=()=>{const{hasRole:oe}=he(),l=oe("admin"),{symbol:M}=be(),[ce,w]=s.useState(!0),[b,P]=s.useState(!1),[I,h]=s.useState(""),[E,v]=s.useState(""),[R,G]=s.useState(""),[W,D]=s.useState(""),[B,N]=s.useState(""),[H,L]=s.useState(""),[U,O]=s.useState("15:00"),[F,K]=s.useState("11:00"),[Y,z]=s.useState("23:00"),[f,J]=s.useState("MYR"),[q,Z]=s.useState("Asia/Kuala_Lumpur"),[$,Q]=s.useState(50),[V,X]=s.useState(8),[ee,te]=s.useState(10),[m,y]=s.useState([]),[x,S]=s.useState([]),[u,T]=s.useState(""),[d,k]=s.useState("");s.useEffect(()=>{se()},[]);const se=async()=>{try{w(!0),h("");const t=xe();G(t.hotel_name),D(t.hotel_address),N(t.hotel_phone),L(t.hotel_email),O(t.check_in_time),K(t.check_out_time),z(t.night_shift_time||"23:00"),J(t.currency),Z(t.timezone),Q(t.room_card_deposit),X(t.service_tax_rate),te(t.tourism_tax_rate),y(t.booking_channels),S(t.payment_methods)}catch(t){console.error("Failed to load settings:",t),h("Failed to load settings")}finally{w(!1)}},ue=async()=>{P(!0),h(""),v("");try{const t={hotel_name:R,hotel_address:W,hotel_phone:B,hotel_email:H,check_in_time:U,check_out_time:F,night_shift_time:Y,currency:f,timezone:q,room_card_deposit:$,late_checkout_penalty:0,service_tax_rate:V,tourism_tax_rate:ee,booking_channels:m,payment_methods:x};pe(t),je(f),window.dispatchEvent(new CustomEvent("currencyChange",{detail:f})),window.dispatchEvent(new CustomEvent("hotelSettingsChange",{detail:t})),v("Settings saved successfully"),setTimeout(()=>v(""),3e3)}catch(t){h(t.message||"Failed to save settings")}finally{P(!1)}};return ce?e.jsx(r,{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"400px",children:e.jsx(ae,{})}):e.jsxs(r,{children:[e.jsx(i,{variant:"h4",component:"h1",gutterBottom:!0,children:"Hotel Settings"}),e.jsx(i,{variant:"body2",color:"text.secondary",sx:{mb:3},children:"Configure your hotel's operational settings"}),I&&e.jsx(c,{severity:"error",sx:{mb:3},onClose:()=>h(""),children:I}),E&&e.jsx(c,{severity:"success",sx:{mb:3},onClose:()=>v(""),children:E}),e.jsx(p,{sx:{mb:3},children:e.jsxs(j,{children:[e.jsxs(r,{sx:{display:"flex",alignItems:"center",mb:2},children:[e.jsx(ve,{sx:{mr:1,color:"primary.main"}}),e.jsx(i,{variant:"h6",children:"Hotel Information"})]}),e.jsx(g,{sx:{mb:3}}),e.jsxs(a,{container:!0,spacing:3,children:[e.jsx(a,{item:!0,xs:12,md:6,children:e.jsx(n,{fullWidth:!0,label:"Hotel Name",value:R,onChange:t=>G(t.target.value),helperText:"The official name of your hotel",disabled:!l})}),e.jsx(a,{item:!0,xs:12,md:6,children:e.jsx(n,{fullWidth:!0,label:"Contact Email",type:"email",value:H,onChange:t=>L(t.target.value),helperText:"Main contact email address",disabled:!l})}),e.jsx(a,{item:!0,xs:12,md:6,children:e.jsx(n,{fullWidth:!0,label:"Contact Phone",value:B,onChange:t=>N(t.target.value),helperText:"Main contact phone number",disabled:!l})}),e.jsx(a,{item:!0,xs:12,md:6,children:e.jsx(n,{fullWidth:!0,label:"Address",value:W,onChange:t=>D(t.target.value),helperText:"Full hotel address",disabled:!l})})]}),!l&&e.jsx(c,{severity:"info",sx:{mt:2},children:"Only administrators can modify hotel information"})]})}),e.jsx(p,{sx:{mb:3},children:e.jsxs(j,{children:[e.jsxs(r,{sx:{display:"flex",alignItems:"center",mb:2},children:[e.jsx(fe,{sx:{mr:1,color:"primary.main"}}),e.jsx(i,{variant:"h6",children:"Check-in & Check-out Times"})]}),e.jsx(g,{sx:{mb:3}}),e.jsxs(a,{container:!0,spacing:3,children:[e.jsx(a,{item:!0,xs:12,md:6,children:e.jsx(n,{fullWidth:!0,label:"Check-in Time",type:"time",value:U,onChange:t=>O(t.target.value),helperText:"Standard time when guests can check in",InputLabelProps:{shrink:!0}})}),e.jsx(a,{item:!0,xs:12,md:6,children:e.jsx(n,{fullWidth:!0,label:"Check-out Time",type:"time",value:F,onChange:t=>K(t.target.value),helperText:"Standard time when guests must check out",InputLabelProps:{shrink:!0}})}),e.jsx(a,{item:!0,xs:12,md:6,children:e.jsx(n,{fullWidth:!0,label:"Night Shift / Night Audit Time",type:"time",value:Y,onChange:t=>z(t.target.value),helperText:"Time when daily data is posted for reporting (e.g., 11:00 PM)",InputLabelProps:{shrink:!0}})})]}),e.jsx(c,{severity:"info",sx:{mt:2},children:"Check-in/out times detect late checkouts. Night shift time determines when daily booking and room data is finalized for reports."})]})}),e.jsx(p,{sx:{mb:3},children:e.jsxs(j,{children:[e.jsxs(r,{sx:{display:"flex",alignItems:"center",mb:2},children:[e.jsx(ie,{sx:{mr:1,color:"primary.main"}}),e.jsx(i,{variant:"h6",children:"Operational Settings"})]}),e.jsx(g,{sx:{mb:3}}),e.jsxs(a,{container:!0,spacing:3,children:[e.jsx(a,{item:!0,xs:12,md:6,children:e.jsxs(n,{select:!0,fullWidth:!0,label:"Default Currency",value:f,onChange:t=>J(t.target.value),helperText:"All prices and charges will be displayed in this currency",disabled:!l,SelectProps:{native:!0},children:[e.jsxs("optgroup",{label:"Recommended",children:[e.jsx("option",{value:"MYR",children:"RM - Malaysian Ringgit (MYR)"}),e.jsx("option",{value:"USD",children:"$ - US Dollar (USD)"})]}),e.jsx("optgroup",{label:"Other Currencies",children:Object.entries(ge).filter(([t])=>t!=="MYR"&&t!=="USD").map(([t,o])=>e.jsxs("option",{value:t,children:[o.symbol," - ",o.name," (",t,")"]},t))})]})}),e.jsx(a,{item:!0,xs:12,md:6,children:e.jsxs(n,{select:!0,fullWidth:!0,label:"Timezone",value:q,onChange:t=>Z(t.target.value),helperText:"Select your hotel's timezone for accurate time tracking",disabled:!l,SelectProps:{native:!0},children:[e.jsx("optgroup",{label:"Asia & Pacific",children:_.filter(t=>t.region==="Asia"||t.region==="Pacific").map(t=>e.jsx("option",{value:t.value,children:t.label},t.value))}),e.jsx("optgroup",{label:"Europe",children:_.filter(t=>t.region==="Europe").map(t=>e.jsx("option",{value:t.value,children:t.label},t.value))}),e.jsx("optgroup",{label:"Americas",children:_.filter(t=>t.region==="Americas").map(t=>e.jsx("option",{value:t.value,children:t.label},t.value))})]})})]}),e.jsxs(c,{severity:"info",sx:{mt:2},children:[e.jsx(i,{variant:"body2",sx:{fontWeight:600,mb:.5},children:"Currency & Timezone Settings"}),e.jsxs(i,{variant:"caption",children:["• Changing the currency will update all price displays throughout the system (bookings, invoices, reports)",e.jsx("br",{}),"• Timezone is used for check-in/check-out times and late checkout penalty calculations",e.jsx("br",{}),"• Malaysia uses Asia/Kuala_Lumpur timezone (GMT+8) and Malaysian Ringgit (MYR)"]})]}),!l&&e.jsx(c,{severity:"warning",sx:{mt:2},children:"Only administrators can modify operational settings"})]})}),e.jsx(p,{sx:{mb:3},children:e.jsxs(j,{children:[e.jsxs(r,{sx:{display:"flex",alignItems:"center",mb:2},children:[e.jsx(ie,{sx:{mr:1,color:"primary.main"}}),e.jsx(i,{variant:"h6",children:"Charges & Deposits"})]}),e.jsx(g,{sx:{mb:3}}),e.jsxs(a,{container:!0,spacing:3,children:[e.jsx(a,{item:!0,xs:12,md:4,children:e.jsx(n,{fullWidth:!0,label:"Room Card Deposit",type:"number",value:$,onChange:t=>Q(parseFloat(t.target.value)||0),helperText:"Default refundable deposit for room card",InputProps:{startAdornment:e.jsx(i,{sx:{mr:.5},children:M})}})}),e.jsx(a,{item:!0,xs:12,md:4,children:e.jsx(n,{fullWidth:!0,label:"Service Tax Rate",type:"number",value:V,onChange:t=>X(parseFloat(t.target.value)||0),helperText:"Tax percentage applied to all bookings",InputProps:{endAdornment:e.jsx(i,{sx:{ml:.5},children:"%"})},inputProps:{min:0,max:100,step:.1}})}),e.jsx(a,{item:!0,xs:12,md:4,children:e.jsx(n,{fullWidth:!0,label:"Tourism Tax Rate",type:"number",value:ee,onChange:t=>te(parseFloat(t.target.value)||0),helperText:"Per night charge for tourist guests",InputProps:{startAdornment:e.jsx(i,{sx:{mr:.5},children:M})},inputProps:{min:0,step:1}})})]}),e.jsx(c,{severity:"info",sx:{mt:2},children:"These amounts will be used as defaults in the quick booking form. Tourism tax is charged per night for guests marked as tourists."})]})}),e.jsx(p,{sx:{mb:3},children:e.jsxs(j,{children:[e.jsxs(r,{sx:{display:"flex",alignItems:"center",mb:2},children:[e.jsx(me,{sx:{mr:1,color:"primary.main"}}),e.jsx(i,{variant:"h6",children:"System Configuration"})]}),e.jsx(g,{sx:{mb:3}}),e.jsxs(a,{container:!0,spacing:3,children:[e.jsxs(a,{item:!0,xs:12,children:[e.jsx(i,{variant:"subtitle1",gutterBottom:!0,fontWeight:"medium",children:"Online Booking Channels"}),e.jsx(i,{variant:"body2",color:"text.secondary",gutterBottom:!0,children:"Configure available booking channels for online check-in"}),e.jsx(ne,{direction:"row",spacing:1,flexWrap:"wrap",sx:{mt:2,mb:2},children:m.map((t,o)=>e.jsx(re,{label:t,onDelete:()=>{y(m.filter((de,A)=>A!==o))},sx:{mb:1}},o))}),e.jsxs(r,{sx:{display:"flex",gap:1},children:[e.jsx(n,{size:"small",placeholder:"Add new booking channel (e.g., Airbnb)",value:u,onChange:t=>T(t.target.value),onKeyPress:t=>{t.key==="Enter"&&u.trim()&&(y([...m,u.trim()]),T(""))},sx:{flex:1}}),e.jsx(C,{variant:"outlined",startIcon:e.jsx(le,{}),onClick:()=>{u.trim()&&(y([...m,u.trim()]),T(""))},disabled:!u.trim(),children:"Add"})]})]}),e.jsxs(a,{item:!0,xs:12,children:[e.jsx(i,{variant:"subtitle1",gutterBottom:!0,fontWeight:"medium",children:"Payment Methods"}),e.jsx(i,{variant:"body2",color:"text.secondary",gutterBottom:!0,children:"Configure available payment methods for walk-in guests"}),e.jsx(ne,{direction:"row",spacing:1,flexWrap:"wrap",sx:{mt:2,mb:2},children:x.map((t,o)=>e.jsx(re,{label:t,onDelete:()=>{S(x.filter((de,A)=>A!==o))},sx:{mb:1}},o))}),e.jsxs(r,{sx:{display:"flex",gap:1},children:[e.jsx(n,{size:"small",placeholder:"Add new payment method (e.g., E-Wallet)",value:d,onChange:t=>k(t.target.value),onKeyPress:t=>{t.key==="Enter"&&d.trim()&&(S([...x,d.trim()]),k(""))},sx:{flex:1}}),e.jsx(C,{variant:"outlined",startIcon:e.jsx(le,{}),onClick:()=>{d.trim()&&(S([...x,d.trim()]),k(""))},disabled:!d.trim(),children:"Add"})]})]})]}),e.jsx(c,{severity:"info",sx:{mt:2},children:"These options will appear in the booking channels dropdown (online check-in) and payment methods dropdown (walk-in guests)."})]})}),e.jsxs(r,{sx:{display:"flex",justifyContent:"flex-end",gap:2},children:[e.jsx(C,{variant:"outlined",onClick:se,disabled:b,children:"Reset Changes"}),e.jsx(C,{variant:"contained",onClick:ue,disabled:b,startIcon:b?e.jsx(ae,{size:20}):e.jsx(ye,{}),children:b?"Saving...":"Save Settings"})]})]})};export{Ge as default};
