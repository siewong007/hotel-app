import{g as pe,a as ge,r as p,u as fe,j as e,s as je,c as ve,b as ye,m as be,d as Re,e as Z,k as ee,H as S,A as ke,B as n,T as o,R as Ce,f as we,P as Se,h as Te,i as Ae}from"./index-DnWmqzJF.js";import{u as De}from"./useCurrency-C4JSCWBJ.js";import{G as u}from"./Grid-0tqG7FTE.js";import{C as Ie}from"./CheckCircle-B5gS3fbx.js";import{S as Be}from"./Schedule-CXw4xcpD.js";import{C as v,a as y}from"./CardContent-BhQI87uj.js";import{R as D,P as te,a as se,C as P,T as W,B as Q,b as V,X as q,Y as J,c as _,L as $e}from"./PieChart-Ba5_fMJJ.js";import{L as T}from"./LinearProgress-ZsFGqIbl.js";import{T as Le}from"./TrendingUp-BioqpNbz.js";import"./currency-SgYezy9c.js";function Oe(s){return String(s).match(/[\d.\-+]*\s*(.*)/)[1]||""}function We(s){return parseFloat(s)}function _e(s){return pe("MuiSkeleton",s)}ge("MuiSkeleton",["root","text","rectangular","rounded","circular","pulse","wave","withChildren","fitContent","heightAuto"]);const Me=s=>{const{classes:r,variant:i,animation:l,hasChildren:h,width:m,height:a}=s;return ye({root:["root",i,l,h&&"withChildren",h&&!m&&"fitContent",h&&!a&&"heightAuto"]},_e,r)},H=ee`
  0% {
    opacity: 1;
  }

  50% {
    opacity: 0.4;
  }

  100% {
    opacity: 1;
  }
`,U=ee`
  0% {
    transform: translateX(-100%);
  }

  50% {
    /* +0.5s of delay between each loop */
    transform: translateX(100%);
  }

  100% {
    transform: translateX(100%);
  }
`,Pe=typeof H!="string"?Z`
        animation: ${H} 2s ease-in-out 0.5s infinite;
      `:null,He=typeof U!="string"?Z`
        &::after {
          animation: ${U} 2s linear 0.5s infinite;
        }
      `:null,Ue=je("span",{name:"MuiSkeleton",slot:"Root",overridesResolver:(s,r)=>{const{ownerState:i}=s;return[r.root,r[i.variant],i.animation!==!1&&r[i.animation],i.hasChildren&&r.withChildren,i.hasChildren&&!i.width&&r.fitContent,i.hasChildren&&!i.height&&r.heightAuto]}})(be(({theme:s})=>{const r=Oe(s.shape.borderRadius)||"px",i=We(s.shape.borderRadius);return{display:"block",backgroundColor:s.vars?s.vars.palette.Skeleton.bg:Re(s.palette.text.primary,s.palette.mode==="light"?.11:.13),height:"1.2em",variants:[{props:{variant:"text"},style:{marginTop:0,marginBottom:0,height:"auto",transformOrigin:"0 55%",transform:"scale(1, 0.60)",borderRadius:`${i}${r}/${Math.round(i/.6*10)/10}${r}`,"&:empty:before":{content:'"\\00a0"'}}},{props:{variant:"circular"},style:{borderRadius:"50%"}},{props:{variant:"rounded"},style:{borderRadius:(s.vars||s).shape.borderRadius}},{props:({ownerState:l})=>l.hasChildren,style:{"& > *":{visibility:"hidden"}}},{props:({ownerState:l})=>l.hasChildren&&!l.width,style:{maxWidth:"fit-content"}},{props:({ownerState:l})=>l.hasChildren&&!l.height,style:{height:"auto"}},{props:{animation:"pulse"},style:Pe||{animation:`${H} 2s ease-in-out 0.5s infinite`}},{props:{animation:"wave"},style:{position:"relative",overflow:"hidden",WebkitMaskImage:"-webkit-radial-gradient(white, black)","&::after":{background:`linear-gradient(
                90deg,
                transparent,
                ${(s.vars||s).palette.action.hover},
                transparent
              )`,content:'""',position:"absolute",transform:"translateX(-100%)",bottom:0,left:0,right:0,top:0}}},{props:{animation:"wave"},style:He||{"&::after":{animation:`${U} 2s linear 0.5s infinite`}}}]}})),M=p.forwardRef(function(r,i){const l=fe({props:r,name:"MuiSkeleton"}),{animation:h="pulse",className:m,component:a="span",height:R,style:f,variant:I="text",width:B,...k}=l,C={...l,animation:h,component:a,variant:I,hasChildren:!!k.children},$=Me(C);return e.jsx(Ue,{as:a,ref:i,className:ve($.root,m),ownerState:C,...k,style:{width:B,height:R,...f}})}),x={available:"#4caf50",occupied:"#ff9800",reserved:"#2196f3",maintenance:"#9e9e9e",cleaning:"#00bcd4"},A=Ce.memo(({title:s,value:r,subtitle:i,icon:l,color:h,trend:m})=>e.jsx(v,{sx:{height:"100%",position:"relative",overflow:"hidden"},children:e.jsx(y,{children:e.jsxs(n,{display:"flex",alignItems:"flex-start",justifyContent:"space-between",children:[e.jsxs(n,{children:[e.jsx(o,{variant:"body2",color:"text.secondary",gutterBottom:!0,children:s}),e.jsx(o,{variant:"h4",component:"div",sx:{fontWeight:700,color:h},children:r}),i&&e.jsx(o,{variant:"caption",color:"text.secondary",children:i}),m&&e.jsxs(n,{display:"flex",alignItems:"center",mt:1,children:[e.jsx(Le,{sx:{fontSize:16,color:m.value>=0?"success.main":"error.main",mr:.5}}),e.jsxs(o,{variant:"caption",color:m.value>=0?"success.main":"error.main",children:[m.value>=0?"+":"",m.value,"% ",m.label]})]})]}),e.jsx(n,{sx:{backgroundColor:`${h}15`,borderRadius:2,p:1.5,display:"flex",alignItems:"center",justifyContent:"center",color:h,"& svg":{fontSize:28}},children:l})]})})})),Ke=({occupancyRate:s})=>{const r=[{name:"Occupied",value:s},{name:"Available",value:100-s}];return e.jsxs(n,{sx:{position:"relative",width:"100%",height:200},children:[e.jsx(D,{children:e.jsx(te,{children:e.jsxs(se,{data:r,cx:"50%",cy:"50%",innerRadius:60,outerRadius:80,startAngle:180,endAngle:0,dataKey:"value",children:[e.jsx(P,{fill:x.occupied}),e.jsx(P,{fill:"#e0e0e0"})]})})}),e.jsxs(n,{sx:{position:"absolute",top:"55%",left:"50%",transform:"translate(-50%, -50%)",textAlign:"center"},children:[e.jsxs(o,{variant:"h3",sx:{fontWeight:700,color:x.occupied},children:[s,"%"]}),e.jsx(o,{variant:"body2",color:"text.secondary",children:"Occupancy"})]})]})},Ge=()=>{const{format:s,symbol:r}=De(),[i,l]=p.useState(!0),[h,m]=p.useState(null),[a,R]=p.useState({totalRooms:0,availableRooms:0,occupiedRooms:0,reservedRooms:0,maintenanceRooms:0,cleaningRooms:0}),[f,I]=p.useState({totalBookings:0,todayCheckIns:0,todayCheckOuts:0,pendingBookings:0}),[B,k]=p.useState([]),[C,$]=p.useState(0),[ae,ne]=p.useState([]),K=p.useCallback(async()=>{try{l(!0);const[c,g,oe,ie]=await Promise.all([S.getAllRooms(),S.getAllBookings(),S.getAllGuests(),S.getRoomTypes()]),j=new Date;j.setHours(0,0,0,0);const re=g.filter(t=>{const d=new Date(t.check_in_date),b=new Date(t.check_out_date);return d.setHours(0,0,0,0),b.setHours(0,0,0,0),t.status==="checked_in"||t.status==="confirmed"&&d<=j&&b>j}),G=new Set(re.map(t=>t.room_number)),le=g.filter(t=>{const d=new Date(t.check_in_date);return d.setHours(0,0,0,0),t.status==="confirmed"&&d.getTime()===j.getTime()}),ce=new Set(le.map(t=>t.room_number));let E=0,X=0,F=0,N=0,z=0;c.forEach(t=>{t.status==="maintenance"?N++:t.status==="cleaning"||t.status==="dirty"?z++:G.has(t.room_number)?X++:ce.has(t.room_number)?F++:E++}),R({totalRooms:c.length,availableRooms:E,occupiedRooms:X,reservedRooms:F,maintenanceRooms:N,cleaningRooms:z});const de=g.filter(t=>{const d=new Date(t.check_in_date);return d.setHours(0,0,0,0),d.getTime()===j.getTime()&&t.status!=="cancelled"}).length,ue=g.filter(t=>{const d=new Date(t.check_out_date);return d.setHours(0,0,0,0),d.getTime()===j.getTime()&&(t.status==="checked_in"||t.status==="completed")}).length,he=g.filter(t=>t.status==="pending"||t.status==="confirmed").length;I({totalBookings:g.length,todayCheckIns:de,todayCheckOuts:ue,pendingBookings:he});const me=ie.map(t=>{const d=c.filter(O=>O.room_type===t.name),b=d.filter(O=>G.has(O.room_number)).length;return{name:t.name,count:d.length,occupied:b,available:d.length-b}}).filter(t=>t.count>0);k(me),$(oe.length);const xe=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],Y=[];for(let t=6;t>=0;t--){const d=new Date;d.setDate(d.getDate()-t),Y.push({name:xe[d.getDay()],revenue:Math.floor(Math.random()*5e3)+2e3})}ne(Y),l(!1)}catch{m("Failed to load analytics data"),l(!1)}},[]);if(p.useEffect(()=>{K()},[K]),h)return e.jsx(ke,{severity:"error",sx:{mt:2},children:h});const w=a.totalRooms>0?Math.round(a.occupiedRooms/a.totalRooms*100):0,L=[{name:"Available",value:a.availableRooms,color:x.available},{name:"Occupied",value:a.occupiedRooms,color:x.occupied},{name:"Reserved",value:a.reservedRooms,color:x.reserved},{name:"Maintenance",value:a.maintenanceRooms,color:x.maintenance},{name:"Cleaning",value:a.cleaningRooms,color:x.cleaning}].filter(c=>c.value>0);return e.jsxs(n,{children:[e.jsxs(n,{sx:{mb:4},children:[e.jsx(o,{variant:"h4",component:"h1",gutterBottom:!0,sx:{fontWeight:700,color:"text.primary"},children:"Hotel Analytics Dashboard"}),e.jsx(o,{variant:"body1",color:"text.secondary",children:"Real-time overview of your hotel performance and occupancy metrics"})]}),i?e.jsxs(u,{container:!0,spacing:3,children:[[1,2,3,4].map(c=>e.jsx(u,{item:!0,xs:12,sm:6,md:3,children:e.jsx(M,{variant:"rectangular",height:120,sx:{borderRadius:2}})},c)),e.jsx(u,{item:!0,xs:12,md:6,children:e.jsx(M,{variant:"rectangular",height:300,sx:{borderRadius:2}})}),e.jsx(u,{item:!0,xs:12,md:6,children:e.jsx(M,{variant:"rectangular",height:300,sx:{borderRadius:2}})})]}):e.jsxs(u,{container:!0,spacing:3,children:[e.jsx(u,{item:!0,xs:12,sm:6,md:3,children:e.jsx(A,{title:"Total Rooms",value:a.totalRooms,subtitle:`${a.availableRooms} available`,icon:e.jsx(we,{}),color:"#1a73e8"})}),e.jsx(u,{item:!0,xs:12,sm:6,md:3,children:e.jsx(A,{title:"Occupancy Rate",value:`${w}%`,subtitle:`${a.occupiedRooms} rooms occupied`,icon:e.jsx(Ie,{}),color:"#34a853",trend:{value:5,label:"vs last week"}})}),e.jsx(u,{item:!0,xs:12,sm:6,md:3,children:e.jsx(A,{title:"Today's Check-ins",value:f.todayCheckIns,subtitle:`${f.todayCheckOuts} check-outs`,icon:e.jsx(Be,{}),color:"#fbbc04"})}),e.jsx(u,{item:!0,xs:12,sm:6,md:3,children:e.jsx(A,{title:"Total Guests",value:C,subtitle:`${f.pendingBookings} pending bookings`,icon:e.jsx(Se,{}),color:"#9c27b0"})}),e.jsx(u,{item:!0,xs:12,md:4,children:e.jsx(v,{sx:{height:"100%"},children:e.jsxs(y,{children:[e.jsx(o,{variant:"h6",sx:{fontWeight:600,mb:2},children:"Current Occupancy"}),e.jsx(Ke,{occupancyRate:w}),e.jsxs(n,{sx:{mt:2},children:[e.jsxs(n,{display:"flex",justifyContent:"space-between",alignItems:"center",mb:1,children:[e.jsx(o,{variant:"body2",color:"text.secondary",children:"Available"}),e.jsxs(o,{variant:"body2",fontWeight:600,color:"success.main",children:[a.availableRooms," rooms"]})]}),e.jsxs(n,{display:"flex",justifyContent:"space-between",alignItems:"center",children:[e.jsx(o,{variant:"body2",color:"text.secondary",children:"Occupied"}),e.jsxs(o,{variant:"body2",fontWeight:600,color:"warning.main",children:[a.occupiedRooms," rooms"]})]})]})]})})}),e.jsx(u,{item:!0,xs:12,md:4,children:e.jsx(v,{sx:{height:"100%"},children:e.jsxs(y,{children:[e.jsx(o,{variant:"h6",sx:{fontWeight:600,mb:2},children:"Room Status Distribution"}),e.jsx(n,{sx:{height:200},children:e.jsx(D,{children:e.jsxs(te,{children:[e.jsx(se,{data:L,cx:"50%",cy:"50%",outerRadius:70,dataKey:"value",label:({name:c,percent:g})=>`${c} ${(g*100).toFixed(0)}%`,labelLine:!1,children:L.map((c,g)=>e.jsx(P,{fill:c.color},`cell-${g}`))}),e.jsx(W,{})]})})}),e.jsx(n,{sx:{display:"flex",flexWrap:"wrap",gap:1,mt:2,justifyContent:"center"},children:L.map(c=>e.jsxs(n,{display:"flex",alignItems:"center",gap:.5,children:[e.jsx(n,{sx:{width:10,height:10,borderRadius:"50%",bgcolor:c.color}}),e.jsx(o,{variant:"caption",children:c.name})]},c.name))})]})})}),e.jsx(u,{item:!0,xs:12,md:4,children:e.jsx(v,{sx:{height:"100%"},children:e.jsxs(y,{children:[e.jsx(o,{variant:"h6",sx:{fontWeight:600,mb:2},children:"Weekly Revenue"}),e.jsx(n,{sx:{height:200},children:e.jsx(D,{children:e.jsxs(Q,{data:ae,children:[e.jsx(V,{strokeDasharray:"3 3",vertical:!1}),e.jsx(q,{dataKey:"name",axisLine:!1,tickLine:!1}),e.jsx(J,{axisLine:!1,tickLine:!1,tickFormatter:c=>`${r}${c/1e3}k`}),e.jsx(W,{formatter:c=>s(c)}),e.jsx(_,{dataKey:"revenue",fill:"#1a73e8",radius:[4,4,0,0]})]})})})]})})}),e.jsx(u,{item:!0,xs:12,md:8,children:e.jsx(v,{children:e.jsxs(y,{children:[e.jsx(o,{variant:"h6",sx:{fontWeight:600,mb:3},children:"Room Type Occupancy"}),e.jsx(n,{sx:{height:250},children:e.jsx(D,{children:e.jsxs(Q,{data:B,layout:"vertical",children:[e.jsx(V,{strokeDasharray:"3 3",horizontal:!1}),e.jsx(q,{type:"number",axisLine:!1,tickLine:!1}),e.jsx(J,{type:"category",dataKey:"name",axisLine:!1,tickLine:!1,width:100}),e.jsx(W,{}),e.jsx($e,{}),e.jsx(_,{dataKey:"occupied",stackId:"a",fill:x.occupied,name:"Occupied",radius:[0,0,0,0]}),e.jsx(_,{dataKey:"available",stackId:"a",fill:x.available,name:"Available",radius:[0,4,4,0]})]})})})]})})}),e.jsx(u,{item:!0,xs:12,md:4,children:e.jsx(v,{sx:{height:"100%"},children:e.jsxs(y,{children:[e.jsx(o,{variant:"h6",sx:{fontWeight:600,mb:3},children:"Quick Stats"}),e.jsxs(n,{sx:{"& > *":{mb:2.5}},children:[e.jsxs(n,{children:[e.jsxs(n,{display:"flex",justifyContent:"space-between",mb:.5,children:[e.jsx(o,{variant:"body2",color:"text.secondary",children:"Room Utilization"}),e.jsxs(o,{variant:"body2",fontWeight:600,children:[w,"%"]})]}),e.jsx(T,{variant:"determinate",value:w,sx:{height:8,borderRadius:4,bgcolor:"#e0e0e0","& .MuiLinearProgress-bar":{bgcolor:x.occupied,borderRadius:4}}})]}),e.jsxs(n,{children:[e.jsxs(n,{display:"flex",justifyContent:"space-between",mb:.5,children:[e.jsx(o,{variant:"body2",color:"text.secondary",children:"Reserved Today"}),e.jsxs(o,{variant:"body2",fontWeight:600,children:[a.reservedRooms," rooms"]})]}),e.jsx(T,{variant:"determinate",value:a.totalRooms>0?a.reservedRooms/a.totalRooms*100:0,sx:{height:8,borderRadius:4,bgcolor:"#e0e0e0","& .MuiLinearProgress-bar":{bgcolor:x.reserved,borderRadius:4}}})]}),e.jsxs(n,{children:[e.jsxs(n,{display:"flex",justifyContent:"space-between",mb:.5,children:[e.jsx(o,{variant:"body2",color:"text.secondary",children:"Under Maintenance"}),e.jsxs(o,{variant:"body2",fontWeight:600,children:[a.maintenanceRooms," rooms"]})]}),e.jsx(T,{variant:"determinate",value:a.totalRooms>0?a.maintenanceRooms/a.totalRooms*100:0,sx:{height:8,borderRadius:4,bgcolor:"#e0e0e0","& .MuiLinearProgress-bar":{bgcolor:x.maintenance,borderRadius:4}}})]}),e.jsxs(n,{children:[e.jsxs(n,{display:"flex",justifyContent:"space-between",mb:.5,children:[e.jsx(o,{variant:"body2",color:"text.secondary",children:"Total Bookings"}),e.jsx(o,{variant:"body2",fontWeight:600,children:f.totalBookings})]}),e.jsx(T,{variant:"determinate",value:100,sx:{height:8,borderRadius:4,bgcolor:"#e0e0e0","& .MuiLinearProgress-bar":{bgcolor:"#9c27b0",borderRadius:4}}})]})]})]})})})]})]})},Ze=()=>{const{hasRole:s}=Te(),r=Ae(),i=s("admin"),l=s("receptionist")||s("manager");return p.useEffect(()=>{!i&&!l&&r("/my-bookings",{replace:!0})},[i,l,r]),i||l?e.jsx(Ge,{}):null};export{Ze as default};
