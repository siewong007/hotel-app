import{l as Ga,j as e,r as l,H as v,B as c,C as je,T as s,o as p,x as Ma,A as E,p as Y,aE as Ha,I as oe,n as i,F as _e,y as be,S as ve,t as C,a0 as Ua,a1 as Bn,L as Va,R as Qa,w as Ya,D as R,P as Ka,f as Xa}from"./index-DnWmqzJF.js";import{u as Ja}from"./useCurrency-C4JSCWBJ.js";import{C as Za}from"./CheckoutInvoiceModal-EWeHLpHP.js";import{C as Xe}from"./Login-D54QK0No.js";import{A as $t}from"./Add-C7DSqfba.js";import{G as a}from"./Grid-0tqG7FTE.js";import{C as fe,a as Je}from"./CardContent-BhQI87uj.js";import{R as es,P as Ze}from"./Receipt-BNM73xOv.js";import{M as ts}from"./AttachMoney-oNl3swnH.js";import{C as ns}from"./CheckCircle-B5gS3fbx.js";import{W as as}from"./Warning-Cw-oqR0p.js";import{B as et}from"./Business-D15Uf3Sq.js";import{C as O}from"./Chip-CSuofl6d.js";import{P as tt}from"./Payment-CMfD5Vf4.js";import{E as nt}from"./Edit-v4qS8plG.js";import{D as at}from"./Delete-CC6nSGco.js";import{F as ss,C as rs}from"./FilterList-CoQMGMK3.js";import{I as qt}from"./InputAdornment-BrN3aL1-.js";import{S as is}from"./Search-CErNxQ4Y.js";import{T as st,a as rt,b as it,c as te,d as o,e as lt}from"./TableRow-B78mTfEk.js";import{T as Pe}from"./TableSortLabel-zmUvbVTn.js";import{D as $,a as q,b as G,c as M}from"./DialogTitle-DKxRfOzX.js";import{A as ot}from"./Autocomplete-CZ6UKh6h.js";import{P as ct}from"./PersonAdd-C6oEVzXr.js";import{L as ls}from"./ListItem-z0t0rr4D.js";import{F as os}from"./FormControlLabel-Ddfix5uo.js";import{C as zn}from"./Checkbox-1RYp8RQ2.js";import{D as cs}from"./Download-B25JP-dd.js";import{S as ds}from"./Snackbar-BmHWVIFe.js";import"./currency-SgYezy9c.js";import"./listItemButtonClasses-Cwcgs-VK.js";const Gt=Ga(e.jsx("path",{d:"M14 2H6c-1.1 0-1.99.9-1.99 2L4 20c0 1.1.89 2 1.99 2H18c1.1 0 2-.9 2-2V8zm2 16H8v-2h8zm0-4H8v-2h8zm-3-5V3.5L18.5 9z"}),"Description"),We=[{value:"accommodation",label:"Accommodation"},{value:"food_beverage",label:"Food & Beverage"},{value:"conference",label:"Conference"},{value:"service",label:"Service"},{value:"other",label:"Other"}],ms=[{value:"cash",label:"Cash"},{value:"card",label:"Credit/Debit Card"},{value:"bank_transfer",label:"Bank Transfer"},{value:"duitnow",label:"DuitNow"},{value:"online_banking",label:"Online Banking"},{value:"cheque",label:"Cheque"}],us=P=>{if(!P)return"";try{const u=new Date(P);return isNaN(u.getTime())?"":u.toISOString().split("T")[0]}catch{return""}},ce=P=>{if(!P)return"-";try{const u=new Date(P);return isNaN(u.getTime())?"-":u.toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"})}catch{return"-"}},Mt=P=>{switch(P){case"paid":return"success";case"partial":return"warning";case"pending":return"info";case"overdue":return"error";case"cancelled":return"default";default:return"default"}},Ht=P=>{switch(P){case"paid":return"Paid";case"partial":return"Partial";case"pending":return"Pending";case"overdue":return"Overdue";case"cancelled":return"Cancelled";default:return P}},Ms=()=>{const{symbol:P,format:u}=Ja(),[H,$n]=l.useState([]),[Ce,qn]=l.useState(null),[Gn,Ut]=l.useState(!0),[Vt,de]=l.useState(null),[L,Qt]=l.useState("created_at"),[ne,dt]=l.useState("desc"),[me,mt]=l.useState(""),[ue,ut]=l.useState("all"),[he,ht]=l.useState("all"),[Mn,Fe]=l.useState(!1),[Yt,Kt]=l.useState(!1),[g,W]=l.useState({company_name:"",description:"",expense_type:"accommodation",amount:0}),[Hn,Te]=l.useState(!1),[re,Xt]=l.useState(null),[S,U]=l.useState({}),[Jt,Zt]=l.useState(!1),[Un,Ae]=l.useState(!1),[V,en]=l.useState(null),[tn,nn]=l.useState(!1),[Vn,Oe]=l.useState(!1),[T,an]=l.useState(null),[xt,sn]=l.useState([]),[Le,rn]=l.useState(0),[B,xe]=l.useState({payment_amount:0,payment_method:"cash"}),[ln,on]=l.useState(!1),[cn,dn]=l.useState([]),[Qn,Ne]=l.useState(null),[Yn,Ee]=l.useState(!1),[I,ie]=l.useState({company_name:"",company_registration_number:"",contact_person:"",contact_email:"",contact_phone:"",billing_address_line1:""}),[Kn,pt]=l.useState(!1),[gt,Xn]=l.useState(null),[K,Jn]=l.useState([]),[Zn,j]=l.useState(!1),[ea,b]=l.useState(""),[ta,Re]=l.useState(!1),[Be,na]=l.useState([]),[yt,mn]=l.useState([]),[aa,sa]=l.useState([]),[un,ze]=l.useState([]),[ra,ia]=l.useState([]),[la,jt]=l.useState(!1),[w,_t]=l.useState(null),[F,bt]=l.useState(null),[X,hn]=l.useState(null),[ae,xn]=l.useState(null),[pe,pn]=l.useState(new Date().toISOString().split("T")[0]),[Se,gn]=l.useState(()=>{const t=new Date;return t.setDate(t.getDate()+1),t.toISOString().split("T")[0]}),[vt,ge]=l.useState(!1),[se,ft]=l.useState(!1),[d,z]=l.useState({first_name:"",last_name:"",email:"",phone:"",ic_number:"",nationality:"",address_line1:"",city:"",state_province:"",postal_code:"",country:""}),[oa,Ie]=l.useState(!1),[Ct,yn]=l.useState(!1),[h,N]=l.useState({company_name:"",registration_number:"",contact_person:"",contact_email:"",contact_phone:"",billing_address:"",billing_city:"",billing_state:"",billing_postal_code:"",credit_limit:"",payment_terms_days:"30",notes:""}),[ca,$e]=l.useState(!1),[jn,_n]=l.useState(null),[St,bn]=l.useState(!1),[x,A]=l.useState({company_name:"",registration_number:"",contact_person:"",contact_email:"",contact_phone:"",billing_address:"",billing_city:"",billing_state:"",billing_postal_code:"",credit_limit:"",payment_terms_days:"30",notes:""}),[da,qe]=l.useState(!1),[J,Ge]=l.useState(null),[It,vn]=l.useState(!1),[ma,Me]=l.useState(!1),[He,fn]=l.useState(null),[wt,Cn]=l.useState([]),[D,Dt]=l.useState(null),[kt,Sn]=l.useState(!1),[k,ye]=l.useState({payment_amount:"",payment_method:"bank_transfer",payment_reference:"",receipt_number:"",notes:""}),[ua,Pt]=l.useState(!1),[f,In]=l.useState(null),[Z,wn]=l.useState([]),[Q,we]=l.useState([]),[Ue,Wt]=l.useState(""),[Dn,Ft]=l.useState(new Date().toISOString().split("T")[0]),[kn,Tt]=l.useState(()=>{const t=new Date;return t.setDate(t.getDate()+30),t.toISOString().split("T")[0]}),[At,Ot]=l.useState(""),[Ve,Qe]=l.useState(!1);l.useEffect(()=>{ee(),Ye(),De(),ha(),Pn()},[]);const Pn=async()=>{try{const n=(await v.getBookingsWithDetails()).filter(r=>r.company_id&&(r.status==="checked_in"||r.status==="auto_checked_in"));ia(n)}catch(t){console.error("Failed to load company bookings:",t)}},Ye=async()=>{try{const n=(await v.getCompanies({is_active:!0})).map(r=>({company_name:r.company_name,company_registration_number:r.registration_number,contact_person:r.contact_person,contact_email:r.contact_email,contact_phone:r.contact_phone,billing_address_line1:r.billing_address}));dn(n)}catch(t){console.error("Failed to load companies:",t)}},De=async()=>{try{const t=await v.getCompanies({is_active:!0});na(t)}catch(t){console.error("Failed to load companies for check-in:",t)}},ha=async()=>{try{const t=await v.getAllGuests();sa(t)}catch(t){console.error("Failed to load guests:",t)}},Lt=async(t,n)=>{try{const r=await v.getAvailableRoomsForDates(t,n);mn(r)}catch(r){console.error("Failed to load available rooms:",r),mn([])}},Wn=async t=>{try{const r=(await v.getBookingsWithDetails()).filter(m=>m.company_id===t);ze(r)}catch(n){console.error("Failed to load company bookings:",n),ze([])}},Fn=async t=>{Re(!0),t&&(bt(t),await Wn(t.id)),await Lt(pe,Se)},xa=async()=>{if(!F||!ae){b("Please select a company and room"),j(!0);return}try{ge(!0);let t=X;if(se){if(!d.first_name||!d.last_name){b("Please enter guest first and last name"),j(!0),ge(!1);return}const m=/^[^\s@]+@[^\s@]+\.[^\s@]+$/;if(!d.email||!m.test(d.email)){b("Please enter a valid email address for the guest"),j(!0),ge(!1);return}t=await v.createGuest({first_name:d.first_name,last_name:d.last_name,email:d.email,phone:d.phone,ic_number:d.ic_number,nationality:d.nationality||void 0,address_line1:d.address_line1||void 0,city:d.city||void 0,state_province:d.state_province||void 0,postal_code:d.postal_code||void 0,country:d.country||void 0})}if(!t){b("Please select or create a guest"),j(!0),ge(!1);return}const n=ae.id||ae.room_id;if(!n){b("Room ID not found. Please select a different room."),j(!0),ge(!1);return}const r=await v.createBooking({guest_id:typeof t.id=="string"?parseInt(t.id,10):t.id,room_id:String(n),check_in_date:pe,check_out_date:Se,post_type:"normal_stay",payment_status:"unpaid",booking_remarks:`Company Billing: ${F.company_name}`});await v.updateBooking(r.id,{company_id:F.id,company_name:F.company_name}),await v.checkInGuest(r.id,{}),b(`Guest ${t.full_name} checked in to Room ${ae.room_number} (Company: ${F.company_name})`),j(!0),Re(!1),Nt(),await ee(),await De()}catch(t){console.error("Failed to perform company check-in:",t),b(t.message||"Failed to perform company check-in"),j(!0)}finally{ge(!1)}},Nt=()=>{bt(null),hn(null),xn(null),pn(new Date().toISOString().split("T")[0]);const t=new Date;t.setDate(t.getDate()+1),gn(t.toISOString().split("T")[0]),ft(!1),z({first_name:"",last_name:"",email:"",phone:"",ic_number:"",nationality:"",address_line1:"",city:"",state_province:"",postal_code:"",country:""}),ze([])},pa=t=>{_t(t),jt(!0)},ga=async t=>{if(w)try{const n={status:"checked_out"};t&&(n.late_checkout_penalty=t.penalty,n.late_checkout_notes=t.notes),await v.updateBooking(w.id,n);const r=t?`Room requires cleaning after late checkout. Late checkout penalty: ${t.penalty}. Notes: ${t.notes||"None"}`:"Room requires cleaning after checkout";if(await v.updateRoomStatus(w.room_id,{status:"dirty",notes:r}),w.company_id&&w.company_name)try{const m=typeof w.total_amount=="string"?parseFloat(w.total_amount):w.total_amount||0,_=(t==null?void 0:t.penalty)||0,y=m+_,le=new Date(w.check_in_date),qa=new Date(w.check_out_date),Rn=Math.ceil((qa.getTime()-le.getTime())/(1e3*60*60*24));let zt=`Room ${w.room_number} - ${w.guest_name}`;zt+=` (${Rn} night${Rn>1?"s":""}: ${w.check_in_date} to ${w.check_out_date})`,_>0&&(zt+=" + Late checkout penalty"),await v.createCustomerLedger({company_name:w.company_name,description:zt,expense_type:"accommodation",amount:y,booking_id:parseInt(w.id),room_number:w.room_number,posting_date:new Date().toISOString().split("T")[0],transaction_date:new Date().toISOString().split("T")[0],post_type:"room_charge",notes:t!=null&&t.notes?`Late checkout: ${t.notes}`:void 0})}catch(m){console.error("Failed to post room charges to company ledger:",m)}b(`${w.guest_name} checked out from Room ${w.room_number}`),j(!0),jt(!1),_t(null),await ee(),await Pn()}catch(n){throw new Error(n.message||"Failed to process checkout")}},ya=async t=>{pn(t),await Lt(t,Se)},ja=async t=>{gn(t),await Lt(pe,t)},Et=()=>{N({company_name:"",registration_number:"",contact_person:"",contact_email:"",contact_phone:"",billing_address:"",billing_city:"",billing_state:"",billing_postal_code:"",credit_limit:"",payment_terms_days:"30",notes:""})},_a=async()=>{if(!h.company_name.trim()){b("Company name is required"),j(!0);return}try{yn(!0),await v.createCompany({company_name:h.company_name.trim(),registration_number:h.registration_number.trim()||void 0,contact_person:h.contact_person.trim()||void 0,contact_email:h.contact_email.trim()||void 0,contact_phone:h.contact_phone.trim()||void 0,billing_address:h.billing_address.trim()||void 0,billing_city:h.billing_city.trim()||void 0,billing_state:h.billing_state.trim()||void 0,billing_postal_code:h.billing_postal_code.trim()||void 0,credit_limit:h.credit_limit?parseFloat(h.credit_limit):void 0,payment_terms_days:h.payment_terms_days?parseInt(h.payment_terms_days):30,notes:h.notes.trim()||void 0}),b(`Company "${h.company_name}" registered successfully`),j(!0),Ie(!1),Et(),await Ye(),await De()}catch(t){console.error("Failed to register company:",t),b(t.message||"Failed to register company"),j(!0)}finally{yn(!1)}},ba=t=>{var n,r;_n(t),A({company_name:t.company_name||"",registration_number:t.registration_number||"",contact_person:t.contact_person||"",contact_email:t.contact_email||"",contact_phone:t.contact_phone||"",billing_address:t.billing_address||"",billing_city:t.billing_city||"",billing_state:t.billing_state||"",billing_postal_code:t.billing_postal_code||"",credit_limit:((n=t.credit_limit)==null?void 0:n.toString())||"",payment_terms_days:((r=t.payment_terms_days)==null?void 0:r.toString())||"30",notes:t.notes||""}),$e(!0)},Rt=()=>{A({company_name:"",registration_number:"",contact_person:"",contact_email:"",contact_phone:"",billing_address:"",billing_city:"",billing_state:"",billing_postal_code:"",credit_limit:"",payment_terms_days:"30",notes:""}),_n(null)},va=async()=>{if(!jn||!x.company_name.trim()){b("Company name is required"),j(!0);return}try{bn(!0),await v.updateCompany(jn.id,{company_name:x.company_name.trim(),registration_number:x.registration_number.trim()||void 0,contact_person:x.contact_person.trim()||void 0,contact_email:x.contact_email.trim()||void 0,contact_phone:x.contact_phone.trim()||void 0,billing_address:x.billing_address.trim()||void 0,billing_city:x.billing_city.trim()||void 0,billing_state:x.billing_state.trim()||void 0,billing_postal_code:x.billing_postal_code.trim()||void 0,credit_limit:x.credit_limit?parseFloat(x.credit_limit):void 0,payment_terms_days:x.payment_terms_days?parseInt(x.payment_terms_days):30,notes:x.notes.trim()||void 0}),b(`Company "${x.company_name}" updated successfully`),j(!0),$e(!1),Rt(),await Ye(),await De()}catch(t){console.error("Failed to update company:",t),b(t.message||"Failed to update company"),j(!0)}finally{bn(!1)}},fa=t=>{Ge(t),qe(!0)},Ca=async()=>{if(J)try{vn(!0),await v.deleteCompany(J.id),b(`Company "${J.company_name}" deleted successfully`),j(!0),qe(!1),Ge(null),await Ye(),await De()}catch(t){console.error("Failed to delete company:",t),b(t.message||"Failed to delete company"),j(!0)}finally{vn(!1)}},Sa=async t=>{fn(t);const n=H.filter(r=>r.company_name===t.company_name&&(r.status==="pending"||r.status==="partial"));Cn(n),Dt(n.length>0?n[0]:null),Me(!0)},Bt=()=>{ye({payment_amount:"",payment_method:"bank_transfer",payment_reference:"",receipt_number:"",notes:""}),fn(null),Cn([]),Dt(null)},Ia=async()=>{if(!D||!k.payment_amount){b("Please select a ledger entry and enter payment amount"),j(!0);return}const t=parseFloat(k.payment_amount);if(isNaN(t)||t<=0){b("Please enter a valid payment amount"),j(!0);return}try{Sn(!0),await v.createLedgerPayment(D.id,{payment_amount:t,payment_method:k.payment_method,payment_reference:k.payment_reference||void 0,receipt_number:k.receipt_number||void 0,notes:k.notes||void 0}),b(`Payment of ${u(t)} recorded successfully`),j(!0),Me(!1),Bt(),await ee()}catch(n){console.error("Failed to record payment:",n),b(n.message||"Failed to record payment"),j(!0)}finally{Sn(!1)}},wa=t=>{In(t);const n=H.filter(y=>y.company_name===t.company_name);wn(n);const r=n.filter(y=>!y.invoice_number&&(y.status==="pending"||y.status==="partial")).map(y=>y.id);we(r);const m=Date.now();Wt(`INV-${t.company_name.substring(0,3).toUpperCase()}-${m.toString().slice(-6)}`);const _=new Date;_.setDate(_.getDate()+(t.payment_terms_days||30)),Tt(_.toISOString().split("T")[0]),Ft(new Date().toISOString().split("T")[0]),Ot(""),Qe(!1),Pt(!0)},Tn=()=>{In(null),wn([]),we([]),Wt(""),Ft(new Date().toISOString().split("T")[0]);const t=new Date;t.setDate(t.getDate()+30),Tt(t.toISOString().split("T")[0]),Ot(""),Qe(!1)},An=t=>{we(n=>n.includes(t)?n.filter(r=>r!==t):[...n,t])},Da=()=>{Q.length===Z.length?we([]):we(Z.map(t=>t.id))},On=()=>Z.filter(t=>Q.includes(t.id)).reduce((t,n)=>{const r=typeof n.amount=="string"?parseFloat(n.amount):n.amount;return t+r},0),Ln=()=>Z.filter(t=>Q.includes(t.id)).reduce((t,n)=>{const r=typeof n.balance_due=="string"?parseFloat(n.balance_due):n.balance_due||0;return t+r},0),Nn=()=>{const t=document.getElementById("company-invoice-content");if(!t)return;const n=window.open("","_blank");n&&(n.document.write(`
      <html>
        <head>
          <title>Invoice ${Ue}</title>
          <style>
            body { font-family: Arial, sans-serif; padding: 20px; max-width: 800px; margin: 0 auto; }
            .header { text-align: center; margin-bottom: 30px; border-bottom: 2px solid #333; padding-bottom: 20px; }
            .header h1 { margin: 0; font-size: 28px; }
            .header p { margin: 5px 0; color: #666; }
            .invoice-info { display: flex; justify-content: space-between; margin: 20px 0; }
            .info-section { flex: 1; }
            .info-section h3 { margin: 0 0 10px 0; font-size: 14px; color: #666; text-transform: uppercase; }
            .info-section p { margin: 3px 0; }
            table { width: 100%; border-collapse: collapse; margin: 20px 0; }
            th, td { padding: 12px; text-align: left; border-bottom: 1px solid #ddd; }
            th { background-color: #f5f5f5; font-weight: bold; }
            .text-right { text-align: right; }
            .total-row { font-weight: bold; font-size: 1.1em; background-color: #f9f9f9; }
            .footer { margin-top: 40px; padding-top: 20px; border-top: 1px solid #ddd; }
            .footer p { margin: 5px 0; color: #666; font-size: 12px; }
            .amount { font-family: monospace; }
            @media print {
              body { padding: 0; }
              .no-print { display: none; }
            }
          </style>
        </head>
        <body>
          ${t.innerHTML}
        </body>
      </html>
    `),n.document.close(),n.print())},ee=async()=>{try{Ut(!0);const[t,n]=await Promise.all([v.getCustomerLedgers(),v.getCustomerLedgerSummary()]);$n(t),qn(n),de(null)}catch(t){console.error("Failed to load ledger data:",t),de(t.message||"Failed to load ledger data. Please check your connection and try again.")}finally{Ut(!1)}},Ke=l.useMemo(()=>{let t=[...H];if(me){const n=me.toLowerCase();t=t.filter(r=>{var m,_;return r.company_name.toLowerCase().includes(n)||r.description.toLowerCase().includes(n)||((m=r.invoice_number)==null?void 0:m.toLowerCase().includes(n))||((_=r.contact_person)==null?void 0:_.toLowerCase().includes(n))})}return ue!=="all"&&(t=t.filter(n=>n.status===ue)),he!=="all"&&(t=t.filter(n=>n.expense_type===he)),t.sort((n,r)=>{let m,_;switch(L){case"company_name":m=n.company_name.toLowerCase(),_=r.company_name.toLowerCase();break;case"amount":m=parseFloat(String(n.amount)),_=parseFloat(String(r.amount));break;case"balance_due":m=parseFloat(String(n.balance_due)),_=parseFloat(String(r.balance_due));break;case"status":m=n.status,_=r.status;break;case"due_date":m=n.due_date?new Date(n.due_date).getTime():0,_=r.due_date?new Date(r.due_date).getTime():0;break;case"created_at":m=new Date(n.created_at).getTime(),_=new Date(r.created_at).getTime();break;default:m=n.created_at,_=r.created_at}return m<_?ne==="asc"?-1:1:m>_?ne==="asc"?1:-1:0}),t},[H,me,ue,he,L,ne]),ke=t=>{L===t?dt(ne==="asc"?"desc":"asc"):(Qt(t),dt("asc"))},ka=()=>{mt(""),ut("all"),ht("all"),Qt("created_at"),dt("desc")},Pa=async()=>{try{Kt(!0),await v.createCustomerLedger(g),b("Ledger entry created successfully!"),j(!0),Fe(!1),En(),await ee()}catch(t){de(t.message||"Failed to create ledger entry")}finally{Kt(!1)}},En=()=>{W({company_name:"",description:"",expense_type:"accommodation",amount:0}),Ne(null)},Wa=t=>{Xt(t),U({company_name:t.company_name,company_registration_number:t.company_registration_number,contact_person:t.contact_person,contact_email:t.contact_email,contact_phone:t.contact_phone,billing_address_line1:t.billing_address_line1,billing_city:t.billing_city,billing_state:t.billing_state,billing_postal_code:t.billing_postal_code,billing_country:t.billing_country,description:t.description,expense_type:t.expense_type,amount:parseFloat(String(t.amount)),status:t.status,due_date:us(t.due_date),notes:t.notes,internal_notes:t.internal_notes}),Te(!0)},Fa=async()=>{if(re)try{Zt(!0),await v.updateCustomerLedger(re.id,S),b("Ledger entry updated successfully!"),j(!0),Te(!1),Xt(null),await ee()}catch(t){de(t.message||"Failed to update ledger entry")}finally{Zt(!1)}},Ta=t=>{en(t),Ae(!0)},Aa=async()=>{if(V)try{nn(!0),await v.deleteCustomerLedger(V.id),b("Ledger entry deleted successfully!"),j(!0),Ae(!1),en(null),await ee()}catch(t){de(t.message||"Failed to delete ledger entry")}finally{nn(!1)}},Oa=async t=>{an(t),xe({payment_amount:parseFloat(String(t.balance_due)),payment_method:"cash"}),rn(0),Oe(!0);try{const n=await v.getLedgerPayments(t.id);sn(n)}catch(n){console.error("Failed to load payment history:",n),sn([])}},La=async()=>{if(T)try{on(!0),await v.createLedgerPayment(T.id,B),b("Payment recorded successfully!"),j(!0),Oe(!1),an(null),await ee()}catch(t){de(t.message||"Failed to record payment")}finally{on(!1)}},Na=t=>t.status!=="paid"&&parseFloat(String(t.paid_amount))===0,Ea=t=>t.status!=="paid"&&t.status!=="cancelled",Ra=async()=>{try{const t=await v.createCompany({company_name:I.company_name,registration_number:I.company_registration_number,contact_person:I.contact_person,contact_email:I.contact_email,contact_phone:I.contact_phone,billing_address:I.billing_address_line1}),n={company_name:t.company_name,company_registration_number:t.registration_number,contact_person:t.contact_person,contact_email:t.contact_email,contact_phone:t.contact_phone,billing_address_line1:t.billing_address};dn([...cn,n]),Ne(n),W({...g,company_name:n.company_name,company_registration_number:n.company_registration_number,contact_person:n.contact_person,contact_email:n.contact_email,contact_phone:n.contact_phone,billing_address_line1:n.billing_address_line1}),Ee(!1),b(`Company "${n.company_name}" registered successfully!`),j(!0),ie({company_name:"",company_registration_number:"",contact_person:"",contact_email:"",contact_phone:"",billing_address_line1:""})}catch(t){console.error("Failed to register company:",t),b((t==null?void 0:t.message)||"Failed to register company"),j(!0)}},Ba=t=>{Xn(t);const n=H.filter(r=>r.company_name===t);Jn(n),pt(!0)},za=()=>{if(document.getElementById("print-statement-content")){const n=window.open("","_blank");if(n){const r=K.reduce((y,le)=>y+parseFloat(String(le.amount)),0),m=K.reduce((y,le)=>y+parseFloat(String(le.paid_amount)),0),_=K.reduce((y,le)=>y+parseFloat(String(le.balance_due)),0);n.document.write(`
          <html>
            <head>
              <title>Company Ledger Statement - ${gt}</title>
              <style>
                body { font-family: Arial, sans-serif; padding: 20px; max-width: 800px; margin: 0 auto; }
                .header { text-align: center; margin-bottom: 30px; border-bottom: 2px solid #333; padding-bottom: 20px; }
                .header h1 { margin: 0; color: #333; }
                .header h2 { margin: 10px 0 0; color: #666; font-weight: normal; }
                .company-info { margin-bottom: 20px; }
                .summary { display: flex; justify-content: space-between; margin-bottom: 20px; background: #f5f5f5; padding: 15px; border-radius: 4px; }
                .summary-item { text-align: center; }
                .summary-item .label { font-size: 12px; color: #666; }
                .summary-item .value { font-size: 18px; font-weight: bold; }
                table { border-collapse: collapse; width: 100%; margin-top: 20px; }
                th, td { border: 1px solid #ddd; padding: 10px; text-align: left; }
                th { background-color: #26a69a; color: white; }
                tr:nth-child(even) { background-color: #f9f9f9; }
                .text-right { text-align: right; }
                .status-paid { color: green; }
                .status-pending { color: orange; }
                .status-overdue { color: red; }
                .footer { margin-top: 30px; text-align: center; color: #666; font-size: 12px; }
                @media print {
                  body { padding: 0; }
                  .no-print { display: none; }
                }
              </style>
            </head>
            <body>
              <div class="header">
                <h1>Salim Inn</h1>
                <h2>Company Ledger Statement</h2>
              </div>
              <div class="company-info">
                <h3>${gt}</h3>
                <p>Statement Date: ${new Date().toLocaleDateString()}</p>
              </div>
              <div class="summary">
                <div class="summary-item">
                  <div class="label">Total Entries</div>
                  <div class="value">${K.length}</div>
                </div>
                <div class="summary-item">
                  <div class="label">Total Amount</div>
                  <div class="value">${u(r)}</div>
                </div>
                <div class="summary-item">
                  <div class="label">Total Paid</div>
                  <div class="value" style="color: green;">${u(m)}</div>
                </div>
                <div class="summary-item">
                  <div class="label">Balance Due</div>
                  <div class="value" style="color: ${_>0?"red":"green"};">${u(_)}</div>
                </div>
              </div>
              <table>
                <thead>
                  <tr>
                    <th>Invoice #</th>
                    <th>Date</th>
                    <th>Description</th>
                    <th>Type</th>
                    <th class="text-right">Amount</th>
                    <th class="text-right">Paid</th>
                    <th class="text-right">Balance</th>
                    <th>Status</th>
                  </tr>
                </thead>
                <tbody>
                  ${K.map(y=>`
                    <tr>
                      <td>${y.invoice_number||"-"}</td>
                      <td>${new Date(y.created_at).toLocaleDateString()}</td>
                      <td>${y.description}</td>
                      <td>${y.expense_type}</td>
                      <td class="text-right">${u(parseFloat(String(y.amount)))}</td>
                      <td class="text-right">${u(parseFloat(String(y.paid_amount)))}</td>
                      <td class="text-right">${u(parseFloat(String(y.balance_due)))}</td>
                      <td class="status-${y.status}">${y.status.toUpperCase()}</td>
                    </tr>
                  `).join("")}
                </tbody>
              </table>
              <div class="footer">
                <p>Generated on ${new Date().toLocaleString()}</p>
                <p>Salim Inn - Hotel Management System</p>
              </div>
            </body>
          </html>
        `),n.document.close(),n.print()}}},$a=l.useMemo(()=>{const t=new Map;return H.forEach(n=>{const r=t.get(n.company_name)||{total:0,balance:0,entries:0};t.set(n.company_name,{total:r.total+parseFloat(String(n.amount)),balance:r.balance+parseFloat(String(n.balance_due)),entries:r.entries+1})}),Array.from(t.entries()).map(([n,r])=>({name:n,...r}))},[H]);return Gn?e.jsx(c,{display:"flex",justifyContent:"center",alignItems:"center",minHeight:"400px",children:e.jsx(je,{})}):e.jsxs(c,{children:[e.jsxs(c,{display:"flex",justifyContent:"space-between",alignItems:"center",mb:3,children:[e.jsx(s,{variant:"h4",component:"h1",children:"Company Ledger"}),e.jsxs(c,{display:"flex",gap:2,children:[e.jsx(p,{variant:"outlined",startIcon:e.jsx(Ma,{}),onClick:ee,children:"Refresh"}),e.jsx(p,{variant:"contained",color:"success",startIcon:e.jsx(Xe,{}),onClick:()=>Fn(),children:"Company Check-In"}),e.jsx(p,{variant:"contained",startIcon:e.jsx($t,{}),onClick:()=>Fe(!0),children:"New Entry"})]})]}),Vt&&e.jsx(E,{severity:"error",sx:{mb:3},action:e.jsx(p,{color:"inherit",size:"small",onClick:ee,children:"Retry"}),children:Vt}),Ce&&e.jsxs(a,{container:!0,spacing:2,mb:3,children:[e.jsx(a,{item:!0,xs:12,sm:6,md:3,children:e.jsx(fe,{children:e.jsxs(Je,{children:[e.jsxs(c,{display:"flex",alignItems:"center",mb:1,children:[e.jsx(es,{color:"primary",sx:{mr:1}}),e.jsx(s,{variant:"h6",children:"Total Entries"})]}),e.jsx(s,{variant:"h4",color:"primary",children:Ce.total_entries})]})})}),e.jsx(a,{item:!0,xs:12,sm:6,md:3,children:e.jsx(fe,{children:e.jsxs(Je,{children:[e.jsxs(c,{display:"flex",alignItems:"center",mb:1,children:[e.jsx(ts,{color:"info",sx:{mr:1}}),e.jsx(s,{variant:"h6",children:"Total Amount"})]}),e.jsx(s,{variant:"h4",color:"info.main",children:u(parseFloat(String(Ce.total_amount)))})]})})}),e.jsx(a,{item:!0,xs:12,sm:6,md:3,children:e.jsx(fe,{children:e.jsxs(Je,{children:[e.jsxs(c,{display:"flex",alignItems:"center",mb:1,children:[e.jsx(ns,{color:"success",sx:{mr:1}}),e.jsx(s,{variant:"h6",children:"Total Paid"})]}),e.jsx(s,{variant:"h4",color:"success.main",children:u(parseFloat(String(Ce.total_paid)))})]})})}),e.jsx(a,{item:!0,xs:12,sm:6,md:3,children:e.jsx(fe,{children:e.jsxs(Je,{children:[e.jsxs(c,{display:"flex",alignItems:"center",mb:1,children:[e.jsx(as,{color:"warning",sx:{mr:1}}),e.jsx(s,{variant:"h6",children:"Outstanding"})]}),e.jsx(s,{variant:"h4",color:"warning.main",children:u(parseFloat(String(Ce.total_outstanding)))})]})})})]}),e.jsxs(fe,{sx:{mb:3,p:2},children:[e.jsxs(c,{display:"flex",alignItems:"center",justifyContent:"space-between",mb:2,children:[e.jsxs(c,{display:"flex",alignItems:"center",gap:1,children:[e.jsx(et,{color:"primary"}),e.jsx(s,{variant:"h6",children:"Registered Companies"}),e.jsx(O,{label:Be.length,size:"small",color:"primary"})]}),e.jsx(p,{variant:"outlined",size:"small",startIcon:e.jsx($t,{}),onClick:()=>Ie(!0),children:"Register Company"})]}),Be.length===0?e.jsx(E,{severity:"info",action:e.jsx(p,{color:"inherit",size:"small",onClick:()=>Ie(!0),children:"Register Now"}),children:'No companies registered yet. Click "Register Company" to add your first company.'}):e.jsx(a,{container:!0,spacing:2,children:Be.map(t=>{const n=$a.find(m=>m.name===t.company_name),r=ra.filter(m=>m.company_id===t.id);return e.jsx(a,{item:!0,xs:12,sm:6,md:4,children:e.jsxs(Y,{variant:"outlined",sx:{p:2,display:"flex",flexDirection:"column",height:"100%","&:hover":{boxShadow:3},transition:"box-shadow 0.2s"},children:[e.jsxs(c,{display:"flex",justifyContent:"space-between",alignItems:"flex-start",mb:1,children:[e.jsxs(c,{sx:{flex:1,minWidth:0},children:[e.jsx(s,{variant:"subtitle1",fontWeight:"bold",noWrap:!0,children:t.company_name}),t.contact_person&&e.jsx(s,{variant:"caption",color:"text.secondary",noWrap:!0,display:"block",children:t.contact_person})]}),r.length>0&&e.jsx(O,{label:`${r.length} Active`,size:"small",color:"success",variant:"filled"})]}),r.length>0&&e.jsxs(c,{sx:{mb:1.5,p:1,bgcolor:"success.50",borderRadius:1},children:[e.jsx(s,{variant:"caption",color:"success.dark",fontWeight:600,sx:{mb:.5,display:"block"},children:"Active Guests:"}),r.slice(0,3).map(m=>e.jsxs(c,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",py:.5,gap:1},children:[e.jsxs(c,{sx:{flex:1,minWidth:0},children:[e.jsx(s,{variant:"caption",noWrap:!0,display:"block",children:m.guest_name}),e.jsx(O,{label:`Room ${m.room_number}`,size:"small",variant:"outlined",sx:{height:18,fontSize:"0.65rem"}})]}),e.jsxs(p,{size:"small",variant:"outlined",color:"error",onClick:()=>pa(m),sx:{minWidth:"auto",px:1,py:.25,fontSize:"0.7rem"},children:[e.jsx(Ha,{sx:{fontSize:14,mr:.5}}),"Out"]})]},m.id)),r.length>3&&e.jsxs(s,{variant:"caption",color:"text.secondary",sx:{mt:.5,display:"block"},children:["+",r.length-3," more guest(s)"]})]}),n&&e.jsxs(c,{sx:{mb:1},children:[e.jsxs(s,{variant:"body2",color:"text.secondary",children:[n.entries," ledger entries"]}),e.jsxs(c,{display:"flex",justifyContent:"space-between",children:[e.jsxs(s,{variant:"body2",children:["Total: ",u(n.total)]}),e.jsxs(s,{variant:"body2",color:n.balance>0?"error.main":"success.main",fontWeight:"medium",children:["Due: ",u(n.balance)]})]})]}),e.jsxs(c,{display:"flex",gap:1,mt:"auto",pt:1,children:[e.jsx(p,{size:"small",variant:"contained",color:"success",startIcon:e.jsx(Xe,{}),onClick:()=>Fn(t),sx:{flex:1},children:"Check-In"}),n&&n.balance>0&&e.jsx(p,{size:"small",variant:"contained",color:"primary",startIcon:e.jsx(tt,{}),onClick:()=>Sa(t),sx:{flex:1},children:"Payment"})]}),e.jsxs(c,{display:"flex",gap:1,pt:.5,children:[e.jsx(oe,{size:"small",color:"primary",onClick:()=>ba(t),title:"Edit Company",children:e.jsx(nt,{fontSize:"small"})}),n&&e.jsxs(e.Fragment,{children:[e.jsx(oe,{size:"small",color:"secondary",onClick:()=>wa(t),title:"Generate Invoice",children:e.jsx(Gt,{fontSize:"small"})}),e.jsx(oe,{size:"small",color:"primary",onClick:()=>Ba(t.company_name),title:"Print Statement",children:e.jsx(Ze,{fontSize:"small"})})]}),e.jsx(oe,{size:"small",color:"error",onClick:()=>fa(t),title:"Delete Company",disabled:r.length>0,children:e.jsx(at,{fontSize:"small"})})]})]})},t.id)})})]}),e.jsxs(fe,{sx:{mb:3,p:2},children:[e.jsxs(c,{display:"flex",alignItems:"center",gap:1,mb:2,children:[e.jsx(ss,{color:"action"}),e.jsx(s,{variant:"h6",children:"Filters & Search"})]}),e.jsxs(a,{container:!0,spacing:2,children:[e.jsx(a,{item:!0,xs:12,md:4,children:e.jsx(i,{fullWidth:!0,size:"small",placeholder:"Search by company, description, invoice...",value:me,onChange:t=>mt(t.target.value),InputProps:{startAdornment:e.jsx(qt,{position:"start",children:e.jsx(is,{})})}})}),e.jsx(a,{item:!0,xs:12,sm:6,md:2,children:e.jsxs(_e,{fullWidth:!0,size:"small",children:[e.jsx(be,{children:"Status"}),e.jsxs(ve,{value:ue,label:"Status",onChange:t=>ut(t.target.value),children:[e.jsx(C,{value:"all",children:"All Status"}),e.jsx(C,{value:"pending",children:"Pending"}),e.jsx(C,{value:"partial",children:"Partial"}),e.jsx(C,{value:"paid",children:"Paid"}),e.jsx(C,{value:"overdue",children:"Overdue"}),e.jsx(C,{value:"cancelled",children:"Cancelled"})]})]})}),e.jsx(a,{item:!0,xs:12,sm:6,md:2,children:e.jsxs(_e,{fullWidth:!0,size:"small",children:[e.jsx(be,{children:"Expense Type"}),e.jsxs(ve,{value:he,label:"Expense Type",onChange:t=>ht(t.target.value),children:[e.jsx(C,{value:"all",children:"All Types"}),We.map(t=>e.jsx(C,{value:t.value,children:t.label},t.value))]})]})}),e.jsx(a,{item:!0,xs:12,md:2,children:e.jsx(p,{fullWidth:!0,variant:"outlined",startIcon:e.jsx(rs,{}),onClick:ka,size:"small",children:"Clear Filters"})})]}),e.jsxs(c,{mt:2,display:"flex",gap:1,flexWrap:"wrap",children:[me&&e.jsx(O,{size:"small",label:`Search: ${me}`,onDelete:()=>mt("")}),ue!=="all"&&e.jsx(O,{size:"small",label:`Status: ${ue}`,onDelete:()=>ut("all")}),he!=="all"&&e.jsx(O,{size:"small",label:`Type: ${he}`,onDelete:()=>ht("all")}),Ke.length!==H.length&&e.jsxs(s,{variant:"body2",color:"text.secondary",sx:{ml:"auto",alignSelf:"center"},children:["Showing ",Ke.length," of ",H.length," entries"]})]})]}),e.jsx(st,{component:Y,children:e.jsxs(rt,{children:[e.jsx(it,{children:e.jsxs(te,{sx:{backgroundColor:"#f5f5f5"},children:[e.jsx(o,{children:e.jsx("strong",{children:"Invoice #"})}),e.jsx(o,{children:e.jsx(Pe,{active:L==="company_name",direction:L==="company_name"?ne:"asc",onClick:()=>ke("company_name"),children:e.jsx("strong",{children:"Company"})})}),e.jsx(o,{children:e.jsx("strong",{children:"Description"})}),e.jsx(o,{children:e.jsx("strong",{children:"Type"})}),e.jsx(o,{children:e.jsx(Pe,{active:L==="amount",direction:L==="amount"?ne:"asc",onClick:()=>ke("amount"),children:e.jsx("strong",{children:"Amount"})})}),e.jsx(o,{children:e.jsx(Pe,{active:L==="balance_due",direction:L==="balance_due"?ne:"asc",onClick:()=>ke("balance_due"),children:e.jsx("strong",{children:"Balance Due"})})}),e.jsx(o,{children:e.jsx(Pe,{active:L==="due_date",direction:L==="due_date"?ne:"asc",onClick:()=>ke("due_date"),children:e.jsx("strong",{children:"Due Date"})})}),e.jsx(o,{children:e.jsx(Pe,{active:L==="status",direction:L==="status"?ne:"asc",onClick:()=>ke("status"),children:e.jsx("strong",{children:"Status"})})}),e.jsx(o,{children:e.jsx("strong",{children:"Actions"})})]})}),e.jsx(lt,{children:Ke.map(t=>{var n;return e.jsxs(te,{hover:!0,children:[e.jsx(o,{children:t.invoice_number||"-"}),e.jsx(o,{children:e.jsxs(c,{children:[e.jsx(s,{variant:"body2",children:t.company_name}),t.contact_person&&e.jsx(s,{variant:"caption",color:"text.secondary",children:t.contact_person})]})}),e.jsx(o,{children:e.jsx(s,{variant:"body2",sx:{maxWidth:200,overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"},children:t.description})}),e.jsx(o,{children:e.jsx(O,{label:((n=We.find(r=>r.value===t.expense_type))==null?void 0:n.label)||t.expense_type,size:"small",variant:"outlined"})}),e.jsx(o,{children:u(parseFloat(String(t.amount)))}),e.jsx(o,{children:e.jsx(s,{color:parseFloat(String(t.balance_due))>0?"error.main":"success.main",fontWeight:"medium",children:u(parseFloat(String(t.balance_due)))})}),e.jsx(o,{children:ce(t.due_date)}),e.jsx(o,{children:e.jsx(O,{label:Ht(t.status),color:Mt(t.status),size:"small"})}),e.jsx(o,{children:e.jsxs(c,{sx:{display:"flex",gap:.5},children:[Ea(t)&&e.jsx(oe,{size:"small",onClick:()=>Oa(t),color:"success",title:"Record Payment",children:e.jsx(tt,{})}),e.jsx(oe,{size:"small",onClick:()=>Wa(t),color:"primary",title:"Edit",children:e.jsx(nt,{})}),Na(t)&&e.jsx(oe,{size:"small",onClick:()=>Ta(t),color:"error",title:"Delete",children:e.jsx(at,{})})]})})]},t.id)})})]})}),Ke.length===0&&e.jsxs(c,{textAlign:"center",py:4,children:[e.jsx(s,{variant:"h6",color:"text.secondary",children:H.length===0?"No ledger entries yet":"No entries match your filters"}),e.jsx(s,{variant:"body2",color:"text.secondary",sx:{mt:1},children:H.length===0?'Create your first ledger entry using the "New Entry" button above':"Try adjusting your search or filter criteria"})]}),e.jsxs($,{open:Mn,onClose:()=>Fe(!1),maxWidth:"md",fullWidth:!0,children:[e.jsx(q,{children:"Create New Ledger Entry"}),e.jsx(G,{children:e.jsxs(a,{container:!0,spacing:2,sx:{mt:1},children:[e.jsx(a,{item:!0,xs:12,sm:6,children:e.jsx(ot,{value:Qn,onChange:(t,n)=>{n?n.isNew?(ie({...I,company_name:n.inputValue||""}),Ee(!0)):(Ne(n),W({...g,company_name:n.company_name,company_registration_number:n.company_registration_number,contact_person:n.contact_person,contact_email:n.contact_email,contact_phone:n.contact_phone,billing_address_line1:n.billing_address_line1})):(Ne(null),W({...g,company_name:""}))},filterOptions:(t,n)=>{const r=n.inputValue.toLowerCase(),m=t.filter(y=>y.company_name.toLowerCase().includes(r)),_=t.some(y=>y.company_name.toLowerCase()===r);return r!==""&&!_&&m.push({inputValue:n.inputValue,company_name:`Add "${n.inputValue}" as new company`,isNew:!0}),m},selectOnFocus:!0,clearOnBlur:!0,handleHomeEndKeys:!0,options:cn,getOptionLabel:t=>t.isNew?t.inputValue||"":t.company_name,isOptionEqualToValue:(t,n)=>t.company_name===n.company_name,renderOption:(t,n)=>{const{key:r,...m}=t;return e.jsx("li",{...m,children:n.isNew?e.jsxs(c,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(ct,{color:"primary",fontSize:"small"}),e.jsx(s,{color:"primary",children:n.company_name})]}):e.jsxs(c,{children:[e.jsx(s,{children:n.company_name}),n.contact_person&&e.jsxs(s,{variant:"caption",color:"text.secondary",children:["Contact: ",n.contact_person]})]})},r)},renderInput:t=>e.jsx(i,{...t,required:!0,label:"Company Name",placeholder:"Type to search or add new company",helperText:"Select existing company or type new name"})})}),e.jsx(a,{item:!0,xs:12,sm:6,children:e.jsx(i,{fullWidth:!0,label:"Registration Number",value:g.company_registration_number||"",onChange:t=>W({...g,company_registration_number:t.target.value})})}),e.jsx(a,{item:!0,xs:12,sm:6,children:e.jsx(i,{fullWidth:!0,label:"Contact Person",value:g.contact_person||"",onChange:t=>W({...g,contact_person:t.target.value})})}),e.jsx(a,{item:!0,xs:12,sm:6,children:e.jsx(i,{fullWidth:!0,label:"Contact Email",type:"email",value:g.contact_email||"",onChange:t=>W({...g,contact_email:t.target.value})})}),e.jsx(a,{item:!0,xs:12,sm:6,children:e.jsx(i,{fullWidth:!0,label:"Contact Phone",value:g.contact_phone||"",onChange:t=>W({...g,contact_phone:t.target.value})})}),e.jsx(a,{item:!0,xs:12,sm:6,children:e.jsx(i,{fullWidth:!0,label:"Billing Address",value:g.billing_address_line1||"",onChange:t=>W({...g,billing_address_line1:t.target.value})})}),e.jsx(a,{item:!0,xs:12,children:e.jsx(i,{fullWidth:!0,required:!0,label:"Description",multiline:!0,rows:2,value:g.description,onChange:t=>W({...g,description:t.target.value})})}),e.jsx(a,{item:!0,xs:12,sm:6,children:e.jsxs(_e,{fullWidth:!0,required:!0,children:[e.jsx(be,{children:"Expense Type"}),e.jsx(ve,{value:g.expense_type,label:"Expense Type",onChange:t=>W({...g,expense_type:t.target.value}),children:We.map(t=>e.jsx(C,{value:t.value,children:t.label},t.value))})]})}),e.jsx(a,{item:!0,xs:12,sm:6,children:e.jsx(i,{fullWidth:!0,required:!0,label:"Amount",type:"number",value:g.amount,onChange:t=>W({...g,amount:parseFloat(t.target.value)||0}),InputProps:{startAdornment:e.jsx(qt,{position:"start",children:P})}})}),e.jsx(a,{item:!0,xs:12,sm:6,children:e.jsx(i,{fullWidth:!0,label:"Invoice Date",type:"date",value:g.invoice_date||"",onChange:t=>W({...g,invoice_date:t.target.value}),InputLabelProps:{shrink:!0}})}),e.jsx(a,{item:!0,xs:12,sm:6,children:e.jsx(i,{fullWidth:!0,label:"Due Date",type:"date",value:g.due_date||"",onChange:t=>W({...g,due_date:t.target.value}),InputLabelProps:{shrink:!0}})}),e.jsx(a,{item:!0,xs:12,children:e.jsx(i,{fullWidth:!0,label:"Notes",multiline:!0,rows:2,value:g.notes||"",onChange:t=>W({...g,notes:t.target.value})})})]})}),e.jsxs(M,{children:[e.jsx(p,{onClick:()=>{Fe(!1),En()},children:"Cancel"}),e.jsx(p,{onClick:Pa,variant:"contained",disabled:Yt||!g.company_name||!g.description||g.amount<=0,children:Yt?"Creating...":"Create Entry"})]})]}),e.jsxs($,{open:Hn,onClose:()=>Te(!1),maxWidth:"md",fullWidth:!0,children:[e.jsxs(q,{children:["Edit Ledger Entry - ",(re==null?void 0:re.invoice_number)||`#${re==null?void 0:re.id}`]}),e.jsx(G,{children:e.jsxs(a,{container:!0,spacing:2,sx:{mt:1},children:[e.jsx(a,{item:!0,xs:12,sm:6,children:e.jsx(i,{fullWidth:!0,label:"Company Name",value:S.company_name||"",onChange:t=>U({...S,company_name:t.target.value})})}),e.jsx(a,{item:!0,xs:12,sm:6,children:e.jsx(i,{fullWidth:!0,label:"Registration Number",value:S.company_registration_number||"",onChange:t=>U({...S,company_registration_number:t.target.value})})}),e.jsx(a,{item:!0,xs:12,sm:6,children:e.jsx(i,{fullWidth:!0,label:"Contact Person",value:S.contact_person||"",onChange:t=>U({...S,contact_person:t.target.value})})}),e.jsx(a,{item:!0,xs:12,sm:6,children:e.jsx(i,{fullWidth:!0,label:"Contact Email",type:"email",value:S.contact_email||"",onChange:t=>U({...S,contact_email:t.target.value})})}),e.jsx(a,{item:!0,xs:12,children:e.jsx(i,{fullWidth:!0,label:"Description",multiline:!0,rows:2,value:S.description||"",onChange:t=>U({...S,description:t.target.value})})}),e.jsx(a,{item:!0,xs:12,sm:6,children:e.jsxs(_e,{fullWidth:!0,children:[e.jsx(be,{children:"Expense Type"}),e.jsx(ve,{value:S.expense_type||"",label:"Expense Type",onChange:t=>U({...S,expense_type:t.target.value}),children:We.map(t=>e.jsx(C,{value:t.value,children:t.label},t.value))})]})}),e.jsx(a,{item:!0,xs:12,sm:6,children:e.jsxs(_e,{fullWidth:!0,children:[e.jsx(be,{children:"Status"}),e.jsxs(ve,{value:S.status||"",label:"Status",onChange:t=>U({...S,status:t.target.value}),children:[e.jsx(C,{value:"pending",children:"Pending"}),e.jsx(C,{value:"partial",children:"Partial"}),e.jsx(C,{value:"paid",children:"Paid"}),e.jsx(C,{value:"overdue",children:"Overdue"}),e.jsx(C,{value:"cancelled",children:"Cancelled"})]})]})}),e.jsx(a,{item:!0,xs:12,sm:6,children:e.jsx(i,{fullWidth:!0,label:"Due Date",type:"date",value:S.due_date||"",onChange:t=>U({...S,due_date:t.target.value}),InputLabelProps:{shrink:!0}})}),e.jsx(a,{item:!0,xs:12,children:e.jsx(i,{fullWidth:!0,label:"Notes",multiline:!0,rows:2,value:S.notes||"",onChange:t=>U({...S,notes:t.target.value})})}),e.jsx(a,{item:!0,xs:12,children:e.jsx(i,{fullWidth:!0,label:"Internal Notes (Staff Only)",multiline:!0,rows:2,value:S.internal_notes||"",onChange:t=>U({...S,internal_notes:t.target.value})})})]})}),e.jsxs(M,{children:[e.jsx(p,{onClick:()=>Te(!1),children:"Cancel"}),e.jsx(p,{onClick:Fa,variant:"contained",disabled:Jt,children:Jt?"Updating...":"Update Entry"})]})]}),e.jsxs($,{open:Un,onClose:()=>Ae(!1),maxWidth:"sm",fullWidth:!0,children:[e.jsx(q,{children:"Delete Ledger Entry"}),e.jsxs(G,{children:[e.jsx(E,{severity:"warning",sx:{mb:2},children:"Are you sure you want to delete this ledger entry? This action cannot be undone."}),e.jsxs(c,{children:[e.jsxs(s,{variant:"body2",children:[e.jsx("strong",{children:"Company:"})," ",V==null?void 0:V.company_name]}),e.jsxs(s,{variant:"body2",children:[e.jsx("strong",{children:"Amount:"})," ",u(parseFloat(String((V==null?void 0:V.amount)||0)))]}),e.jsxs(s,{variant:"body2",children:[e.jsx("strong",{children:"Description:"})," ",V==null?void 0:V.description]})]})]}),e.jsxs(M,{children:[e.jsx(p,{onClick:()=>Ae(!1),children:"Cancel"}),e.jsx(p,{onClick:Aa,variant:"contained",color:"error",disabled:tn,children:tn?"Deleting...":"Delete Entry"})]})]}),e.jsxs($,{open:Vn,onClose:()=>Oe(!1),maxWidth:"md",fullWidth:!0,children:[e.jsxs(q,{children:["Payment - ",T==null?void 0:T.company_name]}),e.jsxs(G,{children:[e.jsxs(Ua,{value:Le,onChange:(t,n)=>rn(n),sx:{mb:2},children:[e.jsx(Bn,{label:"Record Payment"}),e.jsx(Bn,{label:"Payment History"})]}),Le===0&&e.jsxs(c,{children:[e.jsx(E,{severity:"info",sx:{mb:2},children:e.jsxs(s,{variant:"body2",children:[e.jsx("strong",{children:"Total Amount:"})," ",u(parseFloat(String((T==null?void 0:T.amount)||0))),e.jsx("br",{}),e.jsx("strong",{children:"Already Paid:"})," ",u(parseFloat(String((T==null?void 0:T.paid_amount)||0))),e.jsx("br",{}),e.jsx("strong",{children:"Balance Due:"})," ",u(parseFloat(String((T==null?void 0:T.balance_due)||0)))]})}),e.jsxs(a,{container:!0,spacing:2,children:[e.jsx(a,{item:!0,xs:12,sm:6,children:e.jsx(i,{fullWidth:!0,required:!0,label:"Payment Amount",type:"number",value:B.payment_amount,onChange:t=>xe({...B,payment_amount:parseFloat(t.target.value)||0}),InputProps:{startAdornment:e.jsx(qt,{position:"start",children:P})}})}),e.jsx(a,{item:!0,xs:12,sm:6,children:e.jsxs(_e,{fullWidth:!0,required:!0,children:[e.jsx(be,{children:"Payment Method"}),e.jsx(ve,{value:B.payment_method,label:"Payment Method",onChange:t=>xe({...B,payment_method:t.target.value}),children:ms.map(t=>e.jsx(C,{value:t.value,children:t.label},t.value))})]})}),e.jsx(a,{item:!0,xs:12,sm:6,children:e.jsx(i,{fullWidth:!0,label:"Payment Reference",value:B.payment_reference||"",onChange:t=>xe({...B,payment_reference:t.target.value}),placeholder:"Transaction ID, cheque number, etc."})}),e.jsx(a,{item:!0,xs:12,sm:6,children:e.jsx(i,{fullWidth:!0,label:"Receipt Number",value:B.receipt_number||"",onChange:t=>xe({...B,receipt_number:t.target.value})})}),e.jsx(a,{item:!0,xs:12,children:e.jsx(i,{fullWidth:!0,label:"Notes",multiline:!0,rows:2,value:B.notes||"",onChange:t=>xe({...B,notes:t.target.value})})})]})]}),Le===1&&e.jsx(c,{children:xt.length===0?e.jsx(s,{color:"text.secondary",textAlign:"center",py:3,children:"No payment history yet"}):e.jsx(Va,{children:xt.map((t,n)=>e.jsxs(Qa.Fragment,{children:[e.jsx(ls,{children:e.jsx(Ya,{primary:e.jsxs(c,{display:"flex",justifyContent:"space-between",children:[e.jsx(s,{variant:"body1",fontWeight:"medium",children:u(parseFloat(String(t.payment_amount)))}),e.jsx(O,{label:t.payment_method,size:"small",variant:"outlined"})]}),secondary:e.jsxs(e.Fragment,{children:[e.jsx(s,{variant:"body2",color:"text.secondary",children:new Date(t.payment_date).toLocaleString()}),t.payment_reference&&e.jsxs(s,{variant:"caption",color:"text.secondary",children:["Ref: ",t.payment_reference]}),t.notes&&e.jsx(s,{variant:"caption",display:"block",color:"text.secondary",children:t.notes})]})})}),n<xt.length-1&&e.jsx(R,{})]},t.id))})})]}),e.jsxs(M,{children:[e.jsx(p,{onClick:()=>Oe(!1),children:"Close"}),Le===0&&e.jsx(p,{onClick:La,variant:"contained",disabled:ln||B.payment_amount<=0,children:ln?"Processing...":"Record Payment"})]})]}),e.jsxs($,{open:Yn,onClose:()=>Ee(!1),maxWidth:"sm",fullWidth:!0,children:[e.jsx(q,{children:e.jsxs(c,{display:"flex",alignItems:"center",gap:1,children:[e.jsx(ct,{color:"primary"}),"Register New Company"]})}),e.jsxs(G,{children:[e.jsx(E,{severity:"info",sx:{mb:2},children:"This company is not in our system. Please provide the company details below."}),e.jsxs(a,{container:!0,spacing:2,sx:{mt:1},children:[e.jsx(a,{item:!0,xs:12,children:e.jsx(i,{fullWidth:!0,required:!0,label:"Company Name",value:I.company_name,onChange:t=>ie({...I,company_name:t.target.value})})}),e.jsx(a,{item:!0,xs:12,children:e.jsx(i,{fullWidth:!0,label:"Registration Number",value:I.company_registration_number||"",onChange:t=>ie({...I,company_registration_number:t.target.value}),placeholder:"e.g., 123456-A"})}),e.jsx(a,{item:!0,xs:12,sm:6,children:e.jsx(i,{fullWidth:!0,label:"Contact Person",value:I.contact_person||"",onChange:t=>ie({...I,contact_person:t.target.value})})}),e.jsx(a,{item:!0,xs:12,sm:6,children:e.jsx(i,{fullWidth:!0,label:"Contact Email",type:"email",value:I.contact_email||"",onChange:t=>ie({...I,contact_email:t.target.value})})}),e.jsx(a,{item:!0,xs:12,sm:6,children:e.jsx(i,{fullWidth:!0,label:"Contact Phone",value:I.contact_phone||"",onChange:t=>ie({...I,contact_phone:t.target.value})})}),e.jsx(a,{item:!0,xs:12,sm:6,children:e.jsx(i,{fullWidth:!0,label:"Billing Address",value:I.billing_address_line1||"",onChange:t=>ie({...I,billing_address_line1:t.target.value})})})]})]}),e.jsxs(M,{children:[e.jsx(p,{onClick:()=>Ee(!1),children:"Cancel"}),e.jsx(p,{onClick:Ra,variant:"contained",startIcon:e.jsx(ct,{}),disabled:!I.company_name,children:"Register Company"})]})]}),e.jsxs($,{open:Kn,onClose:()=>pt(!1),maxWidth:"md",fullWidth:!0,children:[e.jsx(q,{children:e.jsxs(c,{display:"flex",alignItems:"center",justifyContent:"space-between",children:[e.jsxs(c,{display:"flex",alignItems:"center",gap:1,children:[e.jsx(Ze,{color:"primary"}),"Company Ledger Statement"]}),e.jsx(p,{variant:"contained",startIcon:e.jsx(Ze,{}),onClick:za,children:"Print"})]})}),e.jsx(G,{children:e.jsxs(c,{id:"print-statement-content",children:[e.jsxs(c,{sx:{textAlign:"center",mb:3,borderBottom:"2px solid #333",pb:2},children:[e.jsx(s,{variant:"h4",fontWeight:"bold",children:"Salim Inn"}),e.jsx(s,{variant:"h6",color:"text.secondary",children:"Company Ledger Statement"})]}),e.jsxs(c,{sx:{mb:3},children:[e.jsx(s,{variant:"h5",fontWeight:"bold",children:gt}),e.jsxs(s,{variant:"body2",color:"text.secondary",children:["Statement Date: ",new Date().toLocaleDateString()]})]}),e.jsxs(a,{container:!0,spacing:2,sx:{mb:3},children:[e.jsx(a,{item:!0,xs:3,children:e.jsxs(Y,{sx:{p:2,textAlign:"center",bgcolor:"grey.100"},children:[e.jsx(s,{variant:"caption",color:"text.secondary",children:"Total Entries"}),e.jsx(s,{variant:"h6",fontWeight:"bold",children:K.length})]})}),e.jsx(a,{item:!0,xs:3,children:e.jsxs(Y,{sx:{p:2,textAlign:"center",bgcolor:"grey.100"},children:[e.jsx(s,{variant:"caption",color:"text.secondary",children:"Total Amount"}),e.jsx(s,{variant:"h6",fontWeight:"bold",children:u(K.reduce((t,n)=>t+parseFloat(String(n.amount)),0))})]})}),e.jsx(a,{item:!0,xs:3,children:e.jsxs(Y,{sx:{p:2,textAlign:"center",bgcolor:"success.50"},children:[e.jsx(s,{variant:"caption",color:"text.secondary",children:"Total Paid"}),e.jsx(s,{variant:"h6",fontWeight:"bold",color:"success.main",children:u(K.reduce((t,n)=>t+parseFloat(String(n.paid_amount)),0))})]})}),e.jsx(a,{item:!0,xs:3,children:e.jsxs(Y,{sx:{p:2,textAlign:"center",bgcolor:"error.50"},children:[e.jsx(s,{variant:"caption",color:"text.secondary",children:"Balance Due"}),e.jsx(s,{variant:"h6",fontWeight:"bold",color:"error.main",children:u(K.reduce((t,n)=>t+parseFloat(String(n.balance_due)),0))})]})})]}),e.jsx(st,{component:Y,variant:"outlined",children:e.jsxs(rt,{size:"small",children:[e.jsx(it,{children:e.jsxs(te,{sx:{bgcolor:"primary.main"},children:[e.jsx(o,{sx:{color:"white"},children:"Invoice #"}),e.jsx(o,{sx:{color:"white"},children:"Date"}),e.jsx(o,{sx:{color:"white"},children:"Description"}),e.jsx(o,{sx:{color:"white"},children:"Type"}),e.jsx(o,{sx:{color:"white"},align:"right",children:"Amount"}),e.jsx(o,{sx:{color:"white"},align:"right",children:"Paid"}),e.jsx(o,{sx:{color:"white"},align:"right",children:"Balance"}),e.jsx(o,{sx:{color:"white"},children:"Status"})]})}),e.jsx(lt,{children:K.map(t=>{var n;return e.jsxs(te,{children:[e.jsx(o,{children:t.invoice_number||"-"}),e.jsx(o,{children:new Date(t.created_at).toLocaleDateString()}),e.jsx(o,{children:t.description}),e.jsx(o,{children:e.jsx(O,{label:((n=We.find(r=>r.value===t.expense_type))==null?void 0:n.label)||t.expense_type,size:"small",variant:"outlined"})}),e.jsx(o,{align:"right",children:u(parseFloat(String(t.amount)))}),e.jsx(o,{align:"right",children:u(parseFloat(String(t.paid_amount)))}),e.jsx(o,{align:"right",children:e.jsx(s,{color:parseFloat(String(t.balance_due))>0?"error.main":"success.main",children:u(parseFloat(String(t.balance_due)))})}),e.jsx(o,{children:e.jsx(O,{label:Ht(t.status),color:Mt(t.status),size:"small"})})]},t.id)})})]})}),e.jsx(c,{sx:{mt:3,textAlign:"center",color:"text.secondary"},children:e.jsxs(s,{variant:"caption",children:["Generated on ",new Date().toLocaleString()," | Salim Inn - Hotel Management System"]})})]})}),e.jsx(M,{children:e.jsx(p,{onClick:()=>pt(!1),children:"Close"})})]}),e.jsxs($,{open:ta,onClose:()=>{Re(!1),Nt()},maxWidth:"md",fullWidth:!0,children:[e.jsx(q,{children:e.jsxs(c,{display:"flex",alignItems:"center",gap:1,children:[e.jsx(Xe,{color:"success"}),"Company Check-In"]})}),e.jsx(G,{children:e.jsxs(a,{container:!0,spacing:3,sx:{mt:.5},children:[e.jsx(a,{item:!0,xs:12,children:e.jsx(ot,{value:F,onChange:(t,n)=>{bt(n),n?Wn(n.id):ze([])},options:Be,getOptionLabel:t=>t.company_name,isOptionEqualToValue:(t,n)=>t.id===n.id,renderOption:(t,n)=>{const{key:r,...m}=t;return e.jsx("li",{...m,children:e.jsxs(c,{children:[e.jsx(s,{fontWeight:"medium",children:n.company_name}),n.contact_person&&e.jsxs(s,{variant:"caption",color:"text.secondary",children:["Contact: ",n.contact_person]})]})},r)},renderInput:t=>e.jsx(i,{...t,required:!0,label:"Select Company",placeholder:"Search for a company",InputProps:{...t.InputProps,startAdornment:e.jsxs(e.Fragment,{children:[e.jsx(et,{color:"action",sx:{ml:1,mr:.5}}),t.InputProps.startAdornment]})}})})}),F&&e.jsx(a,{item:!0,xs:12,children:e.jsxs(E,{severity:"info",icon:e.jsx(et,{}),children:[e.jsx(s,{variant:"subtitle2",children:F.company_name}),F.contact_person&&e.jsxs(s,{variant:"body2",children:["Contact: ",F.contact_person]}),F.contact_email&&e.jsxs(s,{variant:"body2",children:["Email: ",F.contact_email]}),un.length>0&&e.jsxs(s,{variant:"body2",sx:{mt:1},children:["Active Bookings: ",un.filter(t=>t.status==="checked_in").length]})]})}),e.jsx(a,{item:!0,xs:12,children:e.jsx(R,{children:e.jsx(O,{label:"Guest Details",size:"small"})})}),e.jsxs(a,{item:!0,xs:12,children:[e.jsxs(c,{display:"flex",alignItems:"center",gap:2,mb:2,children:[e.jsx(p,{variant:se?"outlined":"contained",size:"small",onClick:()=>ft(!1),children:"Select Existing Guest"}),e.jsx(p,{variant:se?"contained":"outlined",size:"small",startIcon:e.jsx(ct,{}),onClick:()=>ft(!0),children:"New Guest"})]}),se?e.jsxs(a,{container:!0,spacing:2,children:[e.jsx(a,{item:!0,xs:12,sm:6,children:e.jsx(i,{fullWidth:!0,required:!0,label:"First Name",value:d.first_name,onChange:t=>z({...d,first_name:t.target.value})})}),e.jsx(a,{item:!0,xs:12,sm:6,children:e.jsx(i,{fullWidth:!0,required:!0,label:"Last Name",value:d.last_name,onChange:t=>z({...d,last_name:t.target.value})})}),e.jsx(a,{item:!0,xs:12,sm:6,children:e.jsx(i,{fullWidth:!0,required:!0,label:"Email",type:"email",value:d.email,onChange:t=>z({...d,email:t.target.value}),helperText:"Required for sending booking confirmations and invoices",error:d.email!==""&&!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(d.email)})}),e.jsx(a,{item:!0,xs:12,sm:6,children:e.jsx(i,{fullWidth:!0,label:"Phone",value:d.phone,onChange:t=>z({...d,phone:t.target.value})})}),e.jsx(a,{item:!0,xs:12,sm:6,children:e.jsx(i,{fullWidth:!0,label:"IC/Passport Number",value:d.ic_number,onChange:t=>z({...d,ic_number:t.target.value})})}),e.jsx(a,{item:!0,xs:12,sm:6,children:e.jsx(i,{fullWidth:!0,label:"Nationality",value:d.nationality,onChange:t=>z({...d,nationality:t.target.value}),placeholder:"e.g. Malaysian"})}),e.jsx(a,{item:!0,xs:12,children:e.jsx(i,{fullWidth:!0,label:"Address",value:d.address_line1,onChange:t=>z({...d,address_line1:t.target.value}),placeholder:"Street address"})}),e.jsx(a,{item:!0,xs:12,sm:6,children:e.jsx(i,{fullWidth:!0,label:"City",value:d.city,onChange:t=>z({...d,city:t.target.value})})}),e.jsx(a,{item:!0,xs:12,sm:6,children:e.jsx(i,{fullWidth:!0,label:"State/Province",value:d.state_province,onChange:t=>z({...d,state_province:t.target.value})})}),e.jsx(a,{item:!0,xs:12,sm:6,children:e.jsx(i,{fullWidth:!0,label:"Postal Code",value:d.postal_code,onChange:t=>z({...d,postal_code:t.target.value})})}),e.jsx(a,{item:!0,xs:12,sm:6,children:e.jsx(i,{fullWidth:!0,label:"Country",value:d.country,onChange:t=>z({...d,country:t.target.value})})})]}):e.jsx(ot,{value:X,onChange:(t,n)=>hn(n),options:aa,getOptionLabel:t=>t.full_name,isOptionEqualToValue:(t,n)=>t.id===n.id,renderOption:(t,n)=>{const{key:r,...m}=t;return e.jsx("li",{...m,children:e.jsxs(c,{children:[e.jsx(s,{children:n.full_name}),e.jsxs(s,{variant:"caption",color:"text.secondary",children:[n.email," ",n.phone&&`| ${n.phone}`]})]})},r)},renderInput:t=>e.jsx(i,{...t,label:"Select Guest",placeholder:"Search for a guest",InputProps:{...t.InputProps,startAdornment:e.jsxs(e.Fragment,{children:[e.jsx(Ka,{color:"action",sx:{ml:1,mr:.5}}),t.InputProps.startAdornment]})}})})]}),e.jsx(a,{item:!0,xs:12,children:e.jsx(R,{children:e.jsx(O,{label:"Room & Dates",size:"small"})})}),e.jsx(a,{item:!0,xs:12,sm:6,children:e.jsx(i,{fullWidth:!0,required:!0,label:"Check-In Date",type:"date",value:pe,onChange:t=>ya(t.target.value),InputLabelProps:{shrink:!0}})}),e.jsx(a,{item:!0,xs:12,sm:6,children:e.jsx(i,{fullWidth:!0,required:!0,label:"Check-Out Date",type:"date",value:Se,onChange:t=>ja(t.target.value),InputLabelProps:{shrink:!0},inputProps:{min:pe}})}),e.jsx(a,{item:!0,xs:12,children:e.jsx(ot,{value:ae,onChange:(t,n)=>xn(n),options:yt,getOptionLabel:t=>`Room ${t.room_number} - ${t.room_type}`,isOptionEqualToValue:(t,n)=>t.id===n.id,renderOption:(t,n)=>{const{key:r,...m}=t,_=typeof n.price_per_night=="string"?parseFloat(n.price_per_night):n.price_per_night;return e.jsx("li",{...m,children:e.jsxs(c,{display:"flex",justifyContent:"space-between",width:"100%",children:[e.jsxs(c,{children:[e.jsxs(s,{fontWeight:"medium",children:["Room ",n.room_number]}),e.jsxs(s,{variant:"caption",color:"text.secondary",children:[n.room_type," | Max: ",n.max_occupancy," guests"]})]}),e.jsxs(s,{color:"primary.main",fontWeight:"medium",children:[u(_),"/night"]})]})},r)},renderInput:t=>e.jsx(i,{...t,required:!0,label:"Select Room",placeholder:"Choose an available room",helperText:yt.length===0?"No rooms available for selected dates":`${yt.length} room(s) available`,InputProps:{...t.InputProps,startAdornment:e.jsxs(e.Fragment,{children:[e.jsx(Xa,{color:"action",sx:{ml:1,mr:.5}}),t.InputProps.startAdornment]})}})})}),F&&ae&&(X||se&&d.first_name)&&e.jsx(a,{item:!0,xs:12,children:e.jsxs(E,{severity:"success",children:[e.jsx(s,{variant:"subtitle2",children:"Ready to Check-In"}),e.jsxs(s,{variant:"body2",children:["Guest: ",se?`${d.first_name} ${d.last_name}`:X==null?void 0:X.full_name]}),e.jsxs(s,{variant:"body2",children:["Email: ",se?d.email:X==null?void 0:X.email]}),e.jsxs(s,{variant:"body2",children:["Room: ",ae.room_number," (",ae.room_type,")"]}),e.jsxs(s,{variant:"body2",children:["Company: ",F.company_name]}),e.jsxs(s,{variant:"body2",children:["Dates: ",ce(pe)," to ",ce(Se)]})]})})]})}),e.jsxs(M,{children:[e.jsx(p,{onClick:()=>{Re(!1),Nt()},children:"Cancel"}),e.jsx(p,{onClick:xa,variant:"contained",color:"success",disabled:vt||!F||!ae||!X&&!se||se&&(!d.first_name||!d.last_name||!d.email||!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(d.email)),startIcon:vt?e.jsx(je,{size:20}):e.jsx(Xe,{}),children:vt?"Processing...":"Check-In Guest"})]})]}),e.jsx(Za,{open:la,onClose:()=>{jt(!1),_t(null)},booking:w,onConfirmCheckout:ga}),e.jsxs($,{open:oa,onClose:()=>{Ie(!1),Et()},maxWidth:"md",fullWidth:!0,children:[e.jsx(q,{children:e.jsxs(c,{display:"flex",alignItems:"center",gap:1,children:[e.jsx(et,{color:"primary"}),"Register New Company"]})}),e.jsx(G,{children:e.jsxs(a,{container:!0,spacing:2,sx:{mt:.5},children:[e.jsx(a,{item:!0,xs:12,children:e.jsx(s,{variant:"subtitle2",color:"primary",gutterBottom:!0,children:"Company Information"})}),e.jsx(a,{item:!0,xs:12,sm:6,children:e.jsx(i,{fullWidth:!0,required:!0,label:"Company Name",value:h.company_name,onChange:t=>N({...h,company_name:t.target.value}),placeholder:"Enter company name"})}),e.jsx(a,{item:!0,xs:12,sm:6,children:e.jsx(i,{fullWidth:!0,label:"Registration Number",value:h.registration_number,onChange:t=>N({...h,registration_number:t.target.value}),placeholder:"Business registration number"})}),e.jsxs(a,{item:!0,xs:12,children:[e.jsx(R,{sx:{my:1}}),e.jsx(s,{variant:"subtitle2",color:"primary",gutterBottom:!0,children:"Contact Information"})]}),e.jsx(a,{item:!0,xs:12,sm:4,children:e.jsx(i,{fullWidth:!0,label:"Contact Person",value:h.contact_person,onChange:t=>N({...h,contact_person:t.target.value}),placeholder:"Primary contact name"})}),e.jsx(a,{item:!0,xs:12,sm:4,children:e.jsx(i,{fullWidth:!0,label:"Contact Email",type:"email",value:h.contact_email,onChange:t=>N({...h,contact_email:t.target.value}),placeholder:"email@company.com"})}),e.jsx(a,{item:!0,xs:12,sm:4,children:e.jsx(i,{fullWidth:!0,label:"Contact Phone",value:h.contact_phone,onChange:t=>N({...h,contact_phone:t.target.value}),placeholder:"+60 12-345 6789"})}),e.jsxs(a,{item:!0,xs:12,children:[e.jsx(R,{sx:{my:1}}),e.jsx(s,{variant:"subtitle2",color:"primary",gutterBottom:!0,children:"Billing Address"})]}),e.jsx(a,{item:!0,xs:12,children:e.jsx(i,{fullWidth:!0,label:"Street Address",value:h.billing_address,onChange:t=>N({...h,billing_address:t.target.value}),placeholder:"Street address, building, floor"})}),e.jsx(a,{item:!0,xs:12,sm:4,children:e.jsx(i,{fullWidth:!0,label:"City",value:h.billing_city,onChange:t=>N({...h,billing_city:t.target.value})})}),e.jsx(a,{item:!0,xs:12,sm:4,children:e.jsx(i,{fullWidth:!0,label:"State",value:h.billing_state,onChange:t=>N({...h,billing_state:t.target.value})})}),e.jsx(a,{item:!0,xs:12,sm:4,children:e.jsx(i,{fullWidth:!0,label:"Postal Code",value:h.billing_postal_code,onChange:t=>N({...h,billing_postal_code:t.target.value})})}),e.jsxs(a,{item:!0,xs:12,children:[e.jsx(R,{sx:{my:1}}),e.jsx(s,{variant:"subtitle2",color:"primary",gutterBottom:!0,children:"Billing Terms"})]}),e.jsx(a,{item:!0,xs:12,sm:6,children:e.jsx(i,{fullWidth:!0,label:"Credit Limit",type:"number",value:h.credit_limit,onChange:t=>N({...h,credit_limit:t.target.value}),placeholder:"0.00",InputProps:{startAdornment:e.jsx(s,{sx:{mr:1},children:P})}})}),e.jsx(a,{item:!0,xs:12,sm:6,children:e.jsx(i,{fullWidth:!0,label:"Payment Terms (Days)",type:"number",value:h.payment_terms_days,onChange:t=>N({...h,payment_terms_days:t.target.value}),helperText:"Number of days for payment after invoice"})}),e.jsx(a,{item:!0,xs:12,children:e.jsx(R,{sx:{my:1}})}),e.jsx(a,{item:!0,xs:12,children:e.jsx(i,{fullWidth:!0,multiline:!0,rows:2,label:"Notes",value:h.notes,onChange:t=>N({...h,notes:t.target.value}),placeholder:"Additional notes about this company..."})})]})}),e.jsxs(M,{children:[e.jsx(p,{onClick:()=>{Ie(!1),Et()},children:"Cancel"}),e.jsx(p,{onClick:_a,variant:"contained",disabled:Ct||!h.company_name.trim(),startIcon:Ct?e.jsx(je,{size:20}):e.jsx($t,{}),children:Ct?"Registering...":"Register Company"})]})]}),e.jsxs($,{open:ca,onClose:()=>{$e(!1),Rt()},maxWidth:"md",fullWidth:!0,children:[e.jsx(q,{children:e.jsxs(c,{display:"flex",alignItems:"center",gap:1,children:[e.jsx(nt,{color:"primary"}),"Edit Company"]})}),e.jsx(G,{children:e.jsxs(a,{container:!0,spacing:2,sx:{mt:.5},children:[e.jsx(a,{item:!0,xs:12,children:e.jsx(s,{variant:"subtitle2",color:"primary",gutterBottom:!0,children:"Company Information"})}),e.jsx(a,{item:!0,xs:12,sm:6,children:e.jsx(i,{fullWidth:!0,required:!0,label:"Company Name",value:x.company_name,onChange:t=>A({...x,company_name:t.target.value})})}),e.jsx(a,{item:!0,xs:12,sm:6,children:e.jsx(i,{fullWidth:!0,label:"Registration Number",value:x.registration_number,onChange:t=>A({...x,registration_number:t.target.value})})}),e.jsxs(a,{item:!0,xs:12,children:[e.jsx(R,{sx:{my:1}}),e.jsx(s,{variant:"subtitle2",color:"primary",gutterBottom:!0,children:"Contact Information"})]}),e.jsx(a,{item:!0,xs:12,sm:4,children:e.jsx(i,{fullWidth:!0,label:"Contact Person",value:x.contact_person,onChange:t=>A({...x,contact_person:t.target.value})})}),e.jsx(a,{item:!0,xs:12,sm:4,children:e.jsx(i,{fullWidth:!0,label:"Contact Email",type:"email",value:x.contact_email,onChange:t=>A({...x,contact_email:t.target.value})})}),e.jsx(a,{item:!0,xs:12,sm:4,children:e.jsx(i,{fullWidth:!0,label:"Contact Phone",value:x.contact_phone,onChange:t=>A({...x,contact_phone:t.target.value})})}),e.jsxs(a,{item:!0,xs:12,children:[e.jsx(R,{sx:{my:1}}),e.jsx(s,{variant:"subtitle2",color:"primary",gutterBottom:!0,children:"Billing Address"})]}),e.jsx(a,{item:!0,xs:12,children:e.jsx(i,{fullWidth:!0,label:"Street Address",value:x.billing_address,onChange:t=>A({...x,billing_address:t.target.value})})}),e.jsx(a,{item:!0,xs:12,sm:4,children:e.jsx(i,{fullWidth:!0,label:"City",value:x.billing_city,onChange:t=>A({...x,billing_city:t.target.value})})}),e.jsx(a,{item:!0,xs:12,sm:4,children:e.jsx(i,{fullWidth:!0,label:"State",value:x.billing_state,onChange:t=>A({...x,billing_state:t.target.value})})}),e.jsx(a,{item:!0,xs:12,sm:4,children:e.jsx(i,{fullWidth:!0,label:"Postal Code",value:x.billing_postal_code,onChange:t=>A({...x,billing_postal_code:t.target.value})})}),e.jsxs(a,{item:!0,xs:12,children:[e.jsx(R,{sx:{my:1}}),e.jsx(s,{variant:"subtitle2",color:"primary",gutterBottom:!0,children:"Billing Terms"})]}),e.jsx(a,{item:!0,xs:12,sm:6,children:e.jsx(i,{fullWidth:!0,label:"Credit Limit",type:"number",value:x.credit_limit,onChange:t=>A({...x,credit_limit:t.target.value}),InputProps:{startAdornment:e.jsx(s,{sx:{mr:1},children:P})}})}),e.jsx(a,{item:!0,xs:12,sm:6,children:e.jsx(i,{fullWidth:!0,label:"Payment Terms (Days)",type:"number",value:x.payment_terms_days,onChange:t=>A({...x,payment_terms_days:t.target.value})})}),e.jsx(a,{item:!0,xs:12,children:e.jsx(R,{sx:{my:1}})}),e.jsx(a,{item:!0,xs:12,children:e.jsx(i,{fullWidth:!0,multiline:!0,rows:2,label:"Notes",value:x.notes,onChange:t=>A({...x,notes:t.target.value})})})]})}),e.jsxs(M,{children:[e.jsx(p,{onClick:()=>{$e(!1),Rt()},children:"Cancel"}),e.jsx(p,{onClick:va,variant:"contained",disabled:St||!x.company_name.trim(),startIcon:St?e.jsx(je,{size:20}):e.jsx(nt,{}),children:St?"Updating...":"Update Company"})]})]}),e.jsxs($,{open:da,onClose:()=>{qe(!1),Ge(null)},maxWidth:"sm",fullWidth:!0,children:[e.jsx(q,{children:e.jsxs(c,{display:"flex",alignItems:"center",gap:1,children:[e.jsx(at,{color:"error"}),"Delete Company"]})}),e.jsxs(G,{children:[e.jsx(E,{severity:"warning",sx:{mb:2},children:"This action cannot be undone."}),e.jsxs(s,{children:["Are you sure you want to delete the company ",e.jsxs("strong",{children:['"',J==null?void 0:J.company_name,'"']}),"?"]}),J&&e.jsxs(c,{sx:{mt:2,p:2,bgcolor:"grey.50",borderRadius:1},children:[e.jsxs(s,{variant:"body2",color:"text.secondary",children:[e.jsx("strong",{children:"Contact:"})," ",J.contact_person||"N/A"]}),e.jsxs(s,{variant:"body2",color:"text.secondary",children:[e.jsx("strong",{children:"Email:"})," ",J.contact_email||"N/A"]}),e.jsxs(s,{variant:"body2",color:"text.secondary",children:[e.jsx("strong",{children:"Phone:"})," ",J.contact_phone||"N/A"]})]})]}),e.jsxs(M,{children:[e.jsx(p,{onClick:()=>{qe(!1),Ge(null)},children:"Cancel"}),e.jsx(p,{onClick:Ca,variant:"contained",color:"error",disabled:It,startIcon:It?e.jsx(je,{size:20}):e.jsx(at,{}),children:It?"Deleting...":"Delete Company"})]})]}),e.jsxs($,{open:ma,onClose:()=>{Me(!1),Bt()},maxWidth:"sm",fullWidth:!0,children:[e.jsx(q,{children:e.jsxs(c,{display:"flex",alignItems:"center",gap:1,children:[e.jsx(tt,{color:"primary"}),"Record Payment"]})}),e.jsxs(G,{children:[He&&e.jsxs(E,{severity:"info",sx:{mb:2},children:[e.jsx(s,{variant:"body2",fontWeight:600,children:He.company_name}),He.contact_person&&e.jsxs(s,{variant:"caption",children:["Contact: ",He.contact_person]})]}),wt.length===0?e.jsx(E,{severity:"warning",children:"No outstanding ledger entries found for this company."}):e.jsxs(a,{container:!0,spacing:2,sx:{mt:.5},children:[e.jsx(a,{item:!0,xs:12,children:e.jsx(i,{select:!0,fullWidth:!0,label:"Select Ledger Entry",value:(D==null?void 0:D.id)||"",onChange:t=>{const n=wt.find(r=>r.id===parseInt(t.target.value));Dt(n||null)},children:wt.map(t=>{const n=typeof t.amount=="string"?parseFloat(t.amount):t.amount,r=typeof t.balance_due=="string"?parseFloat(t.balance_due):t.balance_due||n;return e.jsx(C,{value:t.id,children:e.jsxs(c,{sx:{display:"flex",justifyContent:"space-between",width:"100%"},children:[e.jsx(s,{variant:"body2",noWrap:!0,sx:{flex:1},children:t.description}),e.jsxs(s,{variant:"body2",color:"error.main",fontWeight:600,sx:{ml:2},children:["Due: ",u(r)]})]})},t.id)})})}),D&&e.jsx(a,{item:!0,xs:12,children:e.jsx(Y,{variant:"outlined",sx:{p:2,bgcolor:"grey.50"},children:e.jsxs(a,{container:!0,spacing:1,children:[e.jsxs(a,{item:!0,xs:6,children:[e.jsx(s,{variant:"caption",color:"text.secondary",children:"Description"}),e.jsx(s,{variant:"body2",children:D.description})]}),e.jsxs(a,{item:!0,xs:3,children:[e.jsx(s,{variant:"caption",color:"text.secondary",children:"Total Amount"}),e.jsx(s,{variant:"body2",children:u(typeof D.amount=="string"?parseFloat(D.amount):D.amount)})]}),e.jsxs(a,{item:!0,xs:3,children:[e.jsx(s,{variant:"caption",color:"text.secondary",children:"Balance Due"}),e.jsx(s,{variant:"body2",color:"error.main",fontWeight:600,children:u(typeof D.balance_due=="string"?parseFloat(D.balance_due):D.balance_due||(typeof D.amount=="string"?parseFloat(D.amount):D.amount))})]})]})})}),e.jsx(a,{item:!0,xs:12,sm:6,children:e.jsx(i,{fullWidth:!0,required:!0,label:"Payment Amount",type:"number",value:k.payment_amount,onChange:t=>ye({...k,payment_amount:t.target.value}),InputProps:{startAdornment:e.jsx(s,{sx:{mr:1},children:P})}})}),e.jsx(a,{item:!0,xs:12,sm:6,children:e.jsxs(i,{select:!0,fullWidth:!0,label:"Payment Method",value:k.payment_method,onChange:t=>ye({...k,payment_method:t.target.value}),children:[e.jsx(C,{value:"cash",children:"Cash"}),e.jsx(C,{value:"bank_transfer",children:"Bank Transfer"}),e.jsx(C,{value:"credit_card",children:"Credit Card"}),e.jsx(C,{value:"cheque",children:"Cheque"}),e.jsx(C,{value:"online",children:"Online Payment"})]})}),e.jsx(a,{item:!0,xs:12,sm:6,children:e.jsx(i,{fullWidth:!0,label:"Payment Reference",value:k.payment_reference,onChange:t=>ye({...k,payment_reference:t.target.value}),placeholder:"Transaction ID, cheque number, etc."})}),e.jsx(a,{item:!0,xs:12,sm:6,children:e.jsx(i,{fullWidth:!0,label:"Receipt Number",value:k.receipt_number,onChange:t=>ye({...k,receipt_number:t.target.value})})}),e.jsx(a,{item:!0,xs:12,children:e.jsx(i,{fullWidth:!0,multiline:!0,rows:2,label:"Notes",value:k.notes,onChange:t=>ye({...k,notes:t.target.value}),placeholder:"Additional notes about this payment..."})})]})]}),e.jsxs(M,{children:[e.jsx(p,{onClick:()=>{Me(!1),Bt()},children:"Cancel"}),e.jsx(p,{onClick:Ia,variant:"contained",disabled:kt||!D||!k.payment_amount,startIcon:kt?e.jsx(je,{size:20}):e.jsx(tt,{}),children:kt?"Processing...":"Record Payment"})]})]}),e.jsxs($,{open:ua,onClose:()=>{Pt(!1),Tn()},maxWidth:"md",fullWidth:!0,children:[e.jsx(q,{children:e.jsxs(c,{display:"flex",alignItems:"center",gap:1,children:[e.jsx(Gt,{color:"secondary"}),Ve?"Invoice Preview":"Generate Company Invoice"]})}),e.jsxs(G,{children:[f&&!Ve&&e.jsxs(e.Fragment,{children:[e.jsxs(E,{severity:"info",sx:{mb:2},children:[e.jsx(s,{variant:"body2",fontWeight:600,children:f.company_name}),f.contact_person&&e.jsxs(s,{variant:"caption",children:["Contact: ",f.contact_person]})]}),e.jsxs(a,{container:!0,spacing:2,sx:{mt:.5},children:[e.jsx(a,{item:!0,xs:12,sm:4,children:e.jsx(i,{fullWidth:!0,required:!0,label:"Invoice Number",value:Ue,onChange:t=>Wt(t.target.value)})}),e.jsx(a,{item:!0,xs:12,sm:4,children:e.jsx(i,{fullWidth:!0,required:!0,label:"Invoice Date",type:"date",value:Dn,onChange:t=>Ft(t.target.value),InputLabelProps:{shrink:!0}})}),e.jsx(a,{item:!0,xs:12,sm:4,children:e.jsx(i,{fullWidth:!0,required:!0,label:"Due Date",type:"date",value:kn,onChange:t=>Tt(t.target.value),InputLabelProps:{shrink:!0}})}),e.jsxs(a,{item:!0,xs:12,children:[e.jsx(R,{sx:{my:1}}),e.jsxs(c,{display:"flex",justifyContent:"space-between",alignItems:"center",mb:1,children:[e.jsx(s,{variant:"subtitle1",fontWeight:600,children:"Select Ledger Entries to Include"}),e.jsx(os,{control:e.jsx(zn,{checked:Q.length===Z.length&&Z.length>0,indeterminate:Q.length>0&&Q.length<Z.length,onChange:Da}),label:"Select All"})]})]}),Z.length===0?e.jsx(a,{item:!0,xs:12,children:e.jsx(E,{severity:"warning",children:"No ledger entries found for this company."})}):e.jsxs(a,{item:!0,xs:12,children:[e.jsx(st,{component:Y,variant:"outlined",sx:{maxHeight:300},children:e.jsxs(rt,{size:"small",stickyHeader:!0,children:[e.jsx(it,{children:e.jsxs(te,{children:[e.jsx(o,{padding:"checkbox",children:"Select"}),e.jsx(o,{children:"Description"}),e.jsx(o,{children:"Date"}),e.jsx(o,{children:"Status"}),e.jsx(o,{align:"right",children:"Amount"}),e.jsx(o,{align:"right",children:"Balance"})]})}),e.jsx(lt,{children:Z.map(t=>{const n=typeof t.amount=="string"?parseFloat(t.amount):t.amount,r=typeof t.balance_due=="string"?parseFloat(t.balance_due):t.balance_due||0;return e.jsxs(te,{hover:!0,selected:Q.includes(t.id),onClick:()=>An(t.id),sx:{cursor:"pointer"},children:[e.jsx(o,{padding:"checkbox",children:e.jsx(zn,{checked:Q.includes(t.id),onChange:()=>An(t.id)})}),e.jsxs(o,{children:[e.jsx(s,{variant:"body2",noWrap:!0,sx:{maxWidth:200},children:t.description}),t.invoice_number&&e.jsxs(s,{variant:"caption",color:"text.secondary",children:["Inv: ",t.invoice_number]})]}),e.jsx(o,{children:ce(t.created_at)}),e.jsx(o,{children:e.jsx(O,{label:Ht(t.status),color:Mt(t.status),size:"small"})}),e.jsx(o,{align:"right",children:u(n)}),e.jsx(o,{align:"right",children:e.jsx(s,{color:r>0?"error.main":"success.main",fontWeight:500,children:u(r)})})]},t.id)})})]})}),e.jsx(Y,{variant:"outlined",sx:{p:2,mt:2,bgcolor:"grey.50"},children:e.jsxs(a,{container:!0,spacing:2,children:[e.jsxs(a,{item:!0,xs:4,children:[e.jsx(s,{variant:"caption",color:"text.secondary",children:"Selected Items"}),e.jsx(s,{variant:"h6",children:Q.length})]}),e.jsxs(a,{item:!0,xs:4,children:[e.jsx(s,{variant:"caption",color:"text.secondary",children:"Total Amount"}),e.jsx(s,{variant:"h6",color:"primary.main",children:u(On())})]}),e.jsxs(a,{item:!0,xs:4,children:[e.jsx(s,{variant:"caption",color:"text.secondary",children:"Balance Due"}),e.jsx(s,{variant:"h6",color:"error.main",children:u(Ln())})]})]})})]}),e.jsx(a,{item:!0,xs:12,children:e.jsx(i,{fullWidth:!0,multiline:!0,rows:2,label:"Invoice Notes",value:At,onChange:t=>Ot(t.target.value),placeholder:"Additional notes to include on the invoice..."})})]})]}),f&&Ve&&e.jsxs(c,{id:"company-invoice-content",children:[e.jsxs(c,{className:"header",textAlign:"center",mb:3,pb:2,borderBottom:"2px solid #333",children:[e.jsx(s,{variant:"h4",fontWeight:700,children:"INVOICE"}),e.jsxs(s,{variant:"body2",color:"text.secondary",mt:1,children:["Invoice #",Ue]})]}),e.jsxs(a,{container:!0,spacing:3,mb:3,children:[e.jsxs(a,{item:!0,xs:6,children:[e.jsx(s,{variant:"overline",color:"text.secondary",children:"Bill To"}),e.jsx(s,{variant:"h6",fontWeight:600,children:f.company_name}),f.registration_number&&e.jsxs(s,{variant:"body2",children:["Reg No: ",f.registration_number]}),f.billing_address&&e.jsx(s,{variant:"body2",children:f.billing_address}),(f.billing_city||f.billing_state||f.billing_postal_code)&&e.jsx(s,{variant:"body2",children:[f.billing_city,f.billing_state,f.billing_postal_code].filter(Boolean).join(", ")}),f.contact_person&&e.jsxs(s,{variant:"body2",mt:1,children:["Attn: ",f.contact_person]}),f.contact_email&&e.jsx(s,{variant:"body2",children:f.contact_email})]}),e.jsxs(a,{item:!0,xs:6,textAlign:"right",children:[e.jsx(s,{variant:"overline",color:"text.secondary",children:"Invoice Details"}),e.jsxs(s,{variant:"body2",children:[e.jsx("strong",{children:"Invoice Date:"})," ",ce(Dn)]}),e.jsxs(s,{variant:"body2",children:[e.jsx("strong",{children:"Due Date:"})," ",ce(kn)]}),e.jsxs(s,{variant:"body2",children:[e.jsx("strong",{children:"Payment Terms:"})," ",f.payment_terms_days||30," days"]})]})]}),e.jsx(R,{sx:{my:2}}),e.jsx(st,{component:Y,elevation:0,variant:"outlined",children:e.jsxs(rt,{size:"small",children:[e.jsx(it,{children:e.jsxs(te,{sx:{bgcolor:"#f5f5f5"},children:[e.jsx(o,{children:e.jsx("strong",{children:"Description"})}),e.jsx(o,{children:e.jsx("strong",{children:"Date"})}),e.jsx(o,{children:e.jsx("strong",{children:"Room"})}),e.jsx(o,{align:"right",children:e.jsx("strong",{children:"Amount"})}),e.jsx(o,{align:"right",children:e.jsx("strong",{children:"Paid"})}),e.jsx(o,{align:"right",children:e.jsx("strong",{children:"Balance"})})]})}),e.jsxs(lt,{children:[Z.filter(t=>Q.includes(t.id)).map(t=>{const n=typeof t.amount=="string"?parseFloat(t.amount):t.amount,r=typeof t.paid_amount=="string"?parseFloat(t.paid_amount):t.paid_amount||0,m=typeof t.balance_due=="string"?parseFloat(t.balance_due):t.balance_due||0;return e.jsxs(te,{children:[e.jsx(o,{children:t.description}),e.jsx(o,{children:ce(t.created_at)}),e.jsx(o,{children:t.room_number||"-"}),e.jsx(o,{align:"right",className:"amount",children:u(n)}),e.jsx(o,{align:"right",className:"amount",sx:{color:"success.main"},children:r>0?u(r):"-"}),e.jsx(o,{align:"right",className:"amount",sx:{color:"error.main",fontWeight:600},children:u(m)})]},t.id)}),e.jsxs(te,{sx:{bgcolor:"#f9f9f9"},children:[e.jsx(o,{colSpan:3,align:"right",children:e.jsx("strong",{children:"Subtotal:"})}),e.jsx(o,{align:"right",className:"amount",children:e.jsx("strong",{children:u(On())})}),e.jsx(o,{colSpan:2})]}),e.jsxs(te,{sx:{bgcolor:"#f5f5f5"},children:[e.jsx(o,{colSpan:5,align:"right",children:e.jsx(s,{variant:"h6",children:e.jsx("strong",{children:"Total Amount Due:"})})}),e.jsx(o,{align:"right",children:e.jsx(s,{variant:"h6",color:"error.main",fontWeight:700,children:u(Ln())})})]})]})]})}),At&&e.jsxs(c,{mt:3,children:[e.jsx(s,{variant:"subtitle2",gutterBottom:!0,children:"Notes:"}),e.jsx(s,{variant:"body2",color:"text.secondary",sx:{whiteSpace:"pre-wrap"},children:At})]}),e.jsxs(c,{className:"footer",mt:4,pt:2,borderTop:"1px solid #ddd",children:[e.jsxs(s,{variant:"body2",color:"text.secondary",children:["Please make payment within ",f.payment_terms_days||30," days of invoice date."]}),e.jsx(s,{variant:"body2",color:"text.secondary",mt:1,children:"Thank you for your business!"})]})]})]}),e.jsx(M,{children:Ve?e.jsxs(e.Fragment,{children:[e.jsx(p,{onClick:()=>Qe(!1),children:"Back to Edit"}),e.jsx(p,{onClick:Nn,variant:"outlined",startIcon:e.jsx(Ze,{}),children:"Print"}),e.jsx(p,{onClick:Nn,variant:"contained",startIcon:e.jsx(cs,{}),children:"Download"})]}):e.jsxs(e.Fragment,{children:[e.jsx(p,{onClick:()=>{Pt(!1),Tn()},children:"Cancel"}),e.jsx(p,{onClick:()=>Qe(!0),variant:"contained",disabled:Q.length===0||!Ue,startIcon:e.jsx(Gt,{}),children:"Preview Invoice"})]})})]}),e.jsx(ds,{open:Zn,autoHideDuration:4e3,onClose:()=>j(!1),children:e.jsx(E,{onClose:()=>j(!1),severity:"success",children:ea})})]})};export{Ms as default};
